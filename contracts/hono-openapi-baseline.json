{
  "openapi": "3.1.0",
  "info": {
    "title": "Trading25 API",
    "version": "1.0.0",
    "description": "# Trading25 API\n\nFinancial data analysis API with JQuants integration.\n\n## Two-Layer Architecture\n\n### üîß Layer 1: JQuants Proxy (Development)\nRaw JQuants API data for debugging, verification, and development. Tagged as **jquants**.\n\n**Use for**: Debugging, data verification, custom processing development\n\n### üöÄ Layer 2: Chart & Analytics (Production)\nOptimized, chart-ready data for production applications. Tagged as **chart** and **analytics**.\n\n**Use for**: Web UI, CLI tools, production applications\n\n### üóÇÔ∏è Portfolio Management\nCRUD operations for portfolio tracking. Tagged as **portfolio**.",
    "contact": {
      "name": "Trading25 Team"
    },
    "license": {
      "name": "MIT",
      "url": "https://opensource.org/licenses/MIT"
    }
  },
  "servers": [
    {
      "url": "http://localhost:3001",
      "description": "Development server"
    },
    {
      "url": "https://api.trading25.example.com",
      "description": "Production server (placeholder)"
    }
  ],
  "tags": [
    {
      "name": "Health",
      "description": "üè• Health check endpoints for service monitoring"
    },
    {
      "name": "JQuants Proxy",
      "description": "üîß **Layer 1: JQuants Proxy API** - Raw JQuants data for debugging and development. Use for debugging, data verification, and custom processing. Not optimized for production."
    },
    {
      "name": "Chart",
      "description": "üöÄ **Layer 2: Chart Data API** - Optimized, chart-ready data for production applications. Use for web UI, CLI tools, and production data consumption. Caching enabled."
    },
    {
      "name": "Analytics",
      "description": "üöÄ **Layer 2: Analytics API** - Computed metrics and analytics for production applications. Market rankings, screening results, ROE calculations, and technical indicators."
    },
    {
      "name": "Market",
      "description": "üîÑ **Market Management** - Sync, validate, and refresh market data. Database maintenance operations."
    },
    {
      "name": "Portfolio",
      "description": "üóÇÔ∏è **Portfolio Management** - CRUD operations for portfolio tracking. Manage portfolios and stock holdings."
    }
  ],
  "components": {
    "schemas": {
      "HealthResponse": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string",
            "enum": [
              "ok"
            ]
          },
          "timestamp": {
            "type": "string",
            "format": "date-time"
          }
        },
        "required": [
          "status",
          "timestamp"
        ],
        "description": "Health check response indicating service is operational"
      },
      "AuthStatusResponse": {
        "type": "object",
        "properties": {
          "authenticated": {
            "type": "boolean",
            "description": "Whether API key is configured"
          },
          "hasApiKey": {
            "type": "boolean",
            "description": "Whether an API key is configured"
          }
        },
        "required": [
          "authenticated",
          "hasApiKey"
        ],
        "description": "JQuants API v2 authentication status"
      },
      "ErrorResponse": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string",
            "enum": [
              "error"
            ]
          },
          "error": {
            "type": "string",
            "enum": [
              "Bad Request",
              "Not Found",
              "Conflict",
              "Unprocessable Entity",
              "Not Implemented",
              "Internal Server Error"
            ]
          },
          "message": {
            "type": "string"
          },
          "details": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "field": {
                  "type": "string"
                },
                "message": {
                  "type": "string"
                }
              },
              "required": [
                "field",
                "message"
              ]
            }
          },
          "timestamp": {
            "type": "string",
            "format": "date-time"
          },
          "correlationId": {
            "type": "string",
            "format": "uuid"
          }
        },
        "required": [
          "status",
          "error",
          "message",
          "timestamp",
          "correlationId"
        ],
        "description": "Standard error response with correlation tracking"
      },
      "DailyQuotesResponse": {
        "type": "object",
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "Date": {
                  "type": "string"
                },
                "Code": {
                  "type": "string"
                },
                "O": {
                  "type": "number",
                  "nullable": true
                },
                "H": {
                  "type": "number",
                  "nullable": true
                },
                "L": {
                  "type": "number",
                  "nullable": true
                },
                "C": {
                  "type": "number",
                  "nullable": true
                },
                "UL": {
                  "type": "number",
                  "nullable": true
                },
                "LL": {
                  "type": "number",
                  "nullable": true
                },
                "Vo": {
                  "type": "number",
                  "nullable": true
                },
                "Va": {
                  "type": "number",
                  "nullable": true
                },
                "AdjFactor": {
                  "type": "number"
                },
                "AdjO": {
                  "type": "number",
                  "nullable": true
                },
                "AdjH": {
                  "type": "number",
                  "nullable": true
                },
                "AdjL": {
                  "type": "number",
                  "nullable": true
                },
                "AdjC": {
                  "type": "number",
                  "nullable": true
                },
                "AdjVo": {
                  "type": "number",
                  "nullable": true
                }
              },
              "required": [
                "Date",
                "Code",
                "O",
                "H",
                "L",
                "C",
                "UL",
                "LL",
                "Vo",
                "Va",
                "AdjFactor",
                "AdjO",
                "AdjH",
                "AdjL",
                "AdjC",
                "AdjVo"
              ]
            }
          },
          "pagination_key": {
            "type": "string"
          }
        },
        "required": [
          "data"
        ],
        "description": "Raw daily quotes data from JQuants API v2"
      },
      "ApiIndex": {
        "type": "object",
        "properties": {
          "date": {
            "type": "string",
            "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
          },
          "code": {
            "type": "string"
          },
          "open": {
            "type": "number",
            "minimum": 0,
            "exclusiveMinimum": true
          },
          "high": {
            "type": "number",
            "minimum": 0,
            "exclusiveMinimum": true
          },
          "low": {
            "type": "number",
            "minimum": 0,
            "exclusiveMinimum": true
          },
          "close": {
            "type": "number",
            "minimum": 0,
            "exclusiveMinimum": true
          }
        },
        "required": [
          "date",
          "open",
          "high",
          "low",
          "close"
        ],
        "description": "Index data point for a specific date"
      },
      "ApiIndicesResponse": {
        "type": "object",
        "properties": {
          "indices": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ApiIndex"
            }
          },
          "lastUpdated": {
            "type": "string",
            "format": "date-time"
          }
        },
        "required": [
          "indices",
          "lastUpdated"
        ],
        "description": "Historical index data"
      },
      "ApiListedInfo": {
        "type": "object",
        "properties": {
          "code": {
            "type": "string",
            "minLength": 4,
            "maxLength": 4
          },
          "companyName": {
            "type": "string"
          },
          "companyNameEnglish": {
            "type": "string"
          },
          "marketCode": {
            "type": "string"
          },
          "marketCodeName": {
            "type": "string"
          },
          "sector33Code": {
            "type": "string"
          },
          "sector33CodeName": {
            "type": "string"
          },
          "scaleCategory": {
            "type": "string"
          }
        },
        "required": [
          "code",
          "companyName"
        ],
        "description": "Listed stock information"
      },
      "ApiListedInfoResponse": {
        "type": "object",
        "properties": {
          "info": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ApiListedInfo"
            }
          },
          "lastUpdated": {
            "type": "string",
            "format": "date-time"
          }
        },
        "required": [
          "info",
          "lastUpdated"
        ],
        "description": "Listed stock information data"
      },
      "ApiMarginInterest": {
        "type": "object",
        "properties": {
          "date": {
            "type": "string",
            "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
          },
          "code": {
            "type": "string",
            "minLength": 4,
            "maxLength": 4
          },
          "shortMarginTradeVolume": {
            "type": "number",
            "minimum": 0
          },
          "longMarginTradeVolume": {
            "type": "number",
            "minimum": 0
          },
          "shortMarginOutstandingBalance": {
            "type": "number",
            "minimum": 0
          },
          "longMarginOutstandingBalance": {
            "type": "number",
            "minimum": 0
          }
        },
        "required": [
          "date",
          "code",
          "shortMarginTradeVolume",
          "longMarginTradeVolume"
        ],
        "description": "Weekly margin interest data point"
      },
      "ApiMarginInterestResponse": {
        "type": "object",
        "properties": {
          "marginInterest": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ApiMarginInterest"
            }
          },
          "symbol": {
            "type": "string",
            "minLength": 4,
            "maxLength": 4
          },
          "lastUpdated": {
            "type": "string",
            "format": "date-time"
          }
        },
        "required": [
          "marginInterest",
          "symbol",
          "lastUpdated"
        ],
        "description": "Weekly margin interest data"
      },
      "StatementsResponse": {
        "type": "object",
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "DiscDate": {
                  "type": "string"
                },
                "Code": {
                  "type": "string"
                },
                "CurPerType": {
                  "type": "string"
                },
                "CurPerSt": {
                  "type": "string"
                },
                "CurPerEn": {
                  "type": "string"
                },
                "EPS": {
                  "type": "number",
                  "nullable": true
                },
                "FEPS": {
                  "type": "number",
                  "nullable": true
                },
                "NxFEPS": {
                  "type": "number",
                  "nullable": true
                },
                "NCEPS": {
                  "type": "number",
                  "nullable": true
                },
                "FNCEPS": {
                  "type": "number",
                  "nullable": true
                },
                "NxFNCEPS": {
                  "type": "number",
                  "nullable": true
                }
              },
              "required": [
                "DiscDate",
                "Code",
                "CurPerType",
                "CurPerSt",
                "CurPerEn",
                "EPS",
                "FEPS",
                "NxFEPS",
                "NCEPS",
                "FNCEPS",
                "NxFNCEPS"
              ]
            }
          },
          "pagination_key": {
            "type": "string"
          }
        },
        "required": [
          "data"
        ],
        "description": "Raw financial statements data from JQuants API v2 (EPS fields subset)"
      },
      "TopixRawResponse": {
        "type": "object",
        "properties": {
          "topix": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "Date": {
                  "type": "string"
                },
                "Open": {
                  "type": "number",
                  "nullable": true
                },
                "High": {
                  "type": "number",
                  "nullable": true
                },
                "Low": {
                  "type": "number",
                  "nullable": true
                },
                "Close": {
                  "type": "number",
                  "nullable": true
                }
              },
              "required": [
                "Date",
                "Open",
                "High",
                "Low",
                "Close"
              ]
            }
          }
        },
        "required": [
          "topix"
        ]
      },
      "StockSearchResultItem": {
        "type": "object",
        "properties": {
          "code": {
            "type": "string",
            "minLength": 4,
            "maxLength": 4
          },
          "companyName": {
            "type": "string"
          },
          "companyNameEnglish": {
            "type": "string",
            "nullable": true
          },
          "marketCode": {
            "type": "string"
          },
          "marketName": {
            "type": "string"
          },
          "sector33Name": {
            "type": "string"
          }
        },
        "required": [
          "code",
          "companyName",
          "companyNameEnglish",
          "marketCode",
          "marketName",
          "sector33Name"
        ],
        "description": "Stock search result item"
      },
      "StockSearchResponse": {
        "type": "object",
        "properties": {
          "query": {
            "type": "string"
          },
          "results": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/StockSearchResultItem"
            }
          },
          "count": {
            "type": "number",
            "minimum": 0
          }
        },
        "required": [
          "query",
          "results",
          "count"
        ],
        "description": "Stock search response with matching stocks"
      },
      "ApiStockDataPoint": {
        "type": "object",
        "properties": {
          "time": {
            "type": "string",
            "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
          },
          "open": {
            "type": "number",
            "minimum": 0,
            "exclusiveMinimum": true
          },
          "high": {
            "type": "number",
            "minimum": 0,
            "exclusiveMinimum": true
          },
          "low": {
            "type": "number",
            "minimum": 0,
            "exclusiveMinimum": true
          },
          "close": {
            "type": "number",
            "minimum": 0,
            "exclusiveMinimum": true
          },
          "volume": {
            "type": "number",
            "minimum": 0
          }
        },
        "required": [
          "time",
          "open",
          "high",
          "low",
          "close"
        ],
        "description": "Stock price data point for a specific date"
      },
      "ApiStockDataResponse": {
        "type": "object",
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ApiStockDataPoint"
            }
          },
          "symbol": {
            "type": "string",
            "minLength": 4,
            "maxLength": 4
          },
          "companyName": {
            "type": "string"
          },
          "timeframe": {
            "type": "string"
          },
          "lastUpdated": {
            "type": "string",
            "format": "date-time"
          }
        },
        "required": [
          "data",
          "symbol",
          "timeframe",
          "lastUpdated"
        ],
        "description": "Historical stock price data with metadata"
      },
      "ApiTopixDataPoint": {
        "type": "object",
        "properties": {
          "date": {
            "type": "string",
            "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
          },
          "open": {
            "type": "number",
            "minimum": 0,
            "exclusiveMinimum": true
          },
          "high": {
            "type": "number",
            "minimum": 0,
            "exclusiveMinimum": true
          },
          "low": {
            "type": "number",
            "minimum": 0,
            "exclusiveMinimum": true
          },
          "close": {
            "type": "number",
            "minimum": 0,
            "exclusiveMinimum": true
          },
          "volume": {
            "type": "number",
            "minimum": 0
          }
        },
        "required": [
          "date",
          "open",
          "high",
          "low",
          "close",
          "volume"
        ],
        "description": "TOPIX index data point for a specific date"
      },
      "ApiTopixDataResponse": {
        "type": "object",
        "properties": {
          "topix": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ApiTopixDataPoint"
            }
          },
          "lastUpdated": {
            "type": "string",
            "format": "date-time"
          }
        },
        "required": [
          "topix",
          "lastUpdated"
        ],
        "description": "Historical TOPIX index data"
      },
      "IndexMatch": {
        "type": "object",
        "properties": {
          "indexCode": {
            "type": "string",
            "description": "Index code (e.g., \"0040\", \"0085\")",
            "example": "0085"
          },
          "indexName": {
            "type": "string",
            "description": "Index name",
            "example": "TOPIX-17 Ëá™ÂãïËªä„ÉªËº∏ÈÄÅÊ©ü"
          },
          "category": {
            "type": "string",
            "description": "Index category",
            "example": "sector17"
          },
          "rSquared": {
            "type": "number",
            "description": "R-squared (coefficient of determination) from residual regression",
            "example": 0.421
          },
          "beta": {
            "type": "number",
            "description": "Beta coefficient from residual regression",
            "example": 0.85
          }
        },
        "required": [
          "indexCode",
          "indexName",
          "category",
          "rSquared",
          "beta"
        ]
      },
      "DateRange": {
        "type": "object",
        "properties": {
          "from": {
            "type": "string",
            "description": "Start date of analysis period (YYYY-MM-DD)",
            "example": "2024-01-02"
          },
          "to": {
            "type": "string",
            "description": "End date of analysis period (YYYY-MM-DD)",
            "example": "2024-12-19"
          }
        },
        "required": [
          "from",
          "to"
        ]
      },
      "FactorRegressionResponse": {
        "type": "object",
        "properties": {
          "stockCode": {
            "type": "string",
            "description": "Stock code",
            "example": "7203"
          },
          "companyName": {
            "type": "string",
            "description": "Company name",
            "example": "„Éà„É®„ÇøËá™ÂãïËªä"
          },
          "marketBeta": {
            "type": "number",
            "description": "Market beta (Œ≤m) from TOPIX regression",
            "example": 1.15
          },
          "marketRSquared": {
            "type": "number",
            "description": "R-squared from TOPIX regression (market exposure)",
            "example": 0.653
          },
          "sector17Matches": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/IndexMatch"
            },
            "description": "Top 3 matching TOPIX-17 sector indices"
          },
          "sector33Matches": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/IndexMatch"
            },
            "description": "Top 3 matching 33-sector indices"
          },
          "topixStyleMatches": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/IndexMatch"
            },
            "description": "Top 3 matching TOPIX size + Market + Style indices (excluding TOPIX 0000)"
          },
          "analysisDate": {
            "type": "string",
            "description": "Analysis date (YYYY-MM-DD)",
            "example": "2024-12-20"
          },
          "dataPoints": {
            "type": "number",
            "description": "Number of trading days used in analysis",
            "example": 252
          },
          "dateRange": {
            "$ref": "#/components/schemas/DateRange"
          }
        },
        "required": [
          "stockCode",
          "marketBeta",
          "marketRSquared",
          "sector17Matches",
          "sector33Matches",
          "topixStyleMatches",
          "analysisDate",
          "dataPoints",
          "dateRange"
        ],
        "description": "Two-stage factor regression analysis result for risk decomposition"
      },
      "FundamentalDataPoint": {
        "type": "object",
        "properties": {
          "date": {
            "type": "string",
            "description": "Period end date (YYYY-MM-DD)",
            "example": "2024-03-31"
          },
          "disclosedDate": {
            "type": "string",
            "description": "Disclosure date (YYYY-MM-DD)",
            "example": "2024-05-10"
          },
          "periodType": {
            "type": "string",
            "description": "Period type (FY, Q1, Q2, Q3)",
            "example": "FY"
          },
          "isConsolidated": {
            "type": "boolean",
            "description": "Whether data is consolidated",
            "example": true
          },
          "accountingStandard": {
            "type": "string",
            "nullable": true,
            "description": "Accounting standard (JGAAP, IFRS, US GAAP)",
            "example": "IFRS"
          },
          "roe": {
            "type": "number",
            "nullable": true,
            "description": "Return on Equity (%)",
            "example": 15.5
          },
          "eps": {
            "type": "number",
            "nullable": true,
            "description": "Earnings Per Share (JPY)",
            "example": 250.5
          },
          "dilutedEps": {
            "type": "number",
            "nullable": true,
            "description": "Diluted EPS (JPY)",
            "example": 248
          },
          "bps": {
            "type": "number",
            "nullable": true,
            "description": "Book Value Per Share (JPY)",
            "example": 3500
          },
          "per": {
            "type": "number",
            "nullable": true,
            "description": "Price to Earnings Ratio (calculated with disclosure date price)",
            "example": 12.5
          },
          "pbr": {
            "type": "number",
            "nullable": true,
            "description": "Price to Book Ratio (calculated with disclosure date price)",
            "example": 1.2
          },
          "roa": {
            "type": "number",
            "nullable": true,
            "description": "Return on Assets (%)",
            "example": 8.5
          },
          "operatingMargin": {
            "type": "number",
            "nullable": true,
            "description": "Operating Profit Margin (%)",
            "example": 12
          },
          "netMargin": {
            "type": "number",
            "nullable": true,
            "description": "Net Profit Margin (%)",
            "example": 8
          },
          "stockPrice": {
            "type": "number",
            "nullable": true,
            "description": "Stock price at disclosure date (JPY)",
            "example": 2500
          },
          "netProfit": {
            "type": "number",
            "nullable": true,
            "description": "Net profit (millions of JPY)",
            "example": 250000
          },
          "equity": {
            "type": "number",
            "nullable": true,
            "description": "Shareholders' equity (millions of JPY)",
            "example": 1500000
          },
          "totalAssets": {
            "type": "number",
            "nullable": true,
            "description": "Total assets (millions of JPY)",
            "example": 3000000
          },
          "netSales": {
            "type": "number",
            "nullable": true,
            "description": "Net sales / Revenue (millions of JPY)",
            "example": 5000000
          },
          "operatingProfit": {
            "type": "number",
            "nullable": true,
            "description": "Operating profit (millions of JPY)",
            "example": 600000
          },
          "cashFlowOperating": {
            "type": "number",
            "nullable": true,
            "description": "Cash flows from operating activities (millions of JPY)",
            "example": 500000
          },
          "cashFlowInvesting": {
            "type": "number",
            "nullable": true,
            "description": "Cash flows from investing activities (millions of JPY)",
            "example": -200000
          },
          "cashFlowFinancing": {
            "type": "number",
            "nullable": true,
            "description": "Cash flows from financing activities (millions of JPY)",
            "example": -150000
          },
          "cashAndEquivalents": {
            "type": "number",
            "nullable": true,
            "description": "Cash and cash equivalents (millions of JPY)",
            "example": 800000
          },
          "fcf": {
            "type": "number",
            "nullable": true,
            "description": "Free Cash Flow = CFO + CFI (millions of JPY)",
            "example": 300000
          },
          "fcfYield": {
            "type": "number",
            "nullable": true,
            "description": "FCF Yield = FCF / Market Cap √ó 100 (%)",
            "example": 5.5
          },
          "fcfMargin": {
            "type": "number",
            "nullable": true,
            "description": "FCF Margin = FCF / Net Sales √ó 100 (%)",
            "example": 8
          },
          "forecastEps": {
            "type": "number",
            "nullable": true,
            "description": "Forecast EPS for current/next fiscal year (JPY)",
            "example": 280
          },
          "forecastEpsChangeRate": {
            "type": "number",
            "nullable": true,
            "description": "Change rate from actual EPS to forecast EPS (%)",
            "example": 12
          },
          "revisedForecastEps": {
            "type": "number",
            "nullable": true,
            "description": "Revised forecast EPS from latest quarterly statement (JPY)",
            "example": 452.34
          },
          "revisedForecastSource": {
            "type": "string",
            "nullable": true,
            "description": "Source period type of revised forecast (e.g. Q1, Q2, 3Q)",
            "example": "3Q"
          },
          "prevCashFlowOperating": {
            "type": "number",
            "nullable": true,
            "description": "Previous period cash flows from operating activities (millions of JPY)",
            "example": 450000
          },
          "prevCashFlowInvesting": {
            "type": "number",
            "nullable": true,
            "description": "Previous period cash flows from investing activities (millions of JPY)",
            "example": -180000
          },
          "prevCashFlowFinancing": {
            "type": "number",
            "nullable": true,
            "description": "Previous period cash flows from financing activities (millions of JPY)",
            "example": -120000
          },
          "prevCashAndEquivalents": {
            "type": "number",
            "nullable": true,
            "description": "Previous period cash and cash equivalents (millions of JPY)",
            "example": 750000
          }
        },
        "required": [
          "date",
          "disclosedDate",
          "periodType",
          "isConsolidated",
          "accountingStandard",
          "roe",
          "eps",
          "dilutedEps",
          "bps",
          "per",
          "pbr",
          "roa",
          "operatingMargin",
          "netMargin",
          "stockPrice",
          "netProfit",
          "equity",
          "totalAssets",
          "netSales",
          "operatingProfit",
          "cashFlowOperating",
          "cashFlowInvesting",
          "cashFlowFinancing",
          "cashAndEquivalents",
          "fcf",
          "fcfYield",
          "fcfMargin",
          "forecastEps",
          "forecastEpsChangeRate",
          "prevCashFlowOperating",
          "prevCashFlowInvesting",
          "prevCashFlowFinancing",
          "prevCashAndEquivalents"
        ],
        "description": "Fundamental metrics for a single period"
      },
      "DailyValuationDataPoint": {
        "type": "object",
        "properties": {
          "date": {
            "type": "string",
            "description": "Trading date (YYYY-MM-DD)",
            "example": "2024-12-18"
          },
          "close": {
            "type": "number",
            "description": "Stock close price (JPY)",
            "example": 2500
          },
          "per": {
            "type": "number",
            "nullable": true,
            "description": "Price to Earnings Ratio (calculated with FY EPS)",
            "example": 12.5
          },
          "pbr": {
            "type": "number",
            "nullable": true,
            "description": "Price to Book Ratio (calculated with FY BPS)",
            "example": 1.2
          }
        },
        "required": [
          "date",
          "close",
          "per",
          "pbr"
        ],
        "description": "Daily valuation metrics calculated with trading day close price and FY EPS/BPS"
      },
      "FundamentalsResponse": {
        "type": "object",
        "properties": {
          "symbol": {
            "type": "string",
            "description": "Stock symbol (4-character code)",
            "example": "7203"
          },
          "companyName": {
            "type": "string",
            "description": "Company name",
            "example": "Toyota Motor Corporation"
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/FundamentalDataPoint"
            },
            "description": "Time series data sorted by date descending"
          },
          "latestMetrics": {
            "allOf": [
              {
                "$ref": "#/components/schemas/FundamentalDataPoint"
              },
              {
                "description": "Most recent metrics (convenience field)"
              }
            ]
          },
          "dailyValuation": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DailyValuationDataPoint"
            },
            "description": "Daily PER/PBR time series (calculated with daily close prices and FY EPS/BPS)"
          },
          "lastUpdated": {
            "type": "string",
            "format": "date-time",
            "description": "Last updated timestamp",
            "example": "2024-12-18T12:00:00Z"
          }
        },
        "required": [
          "symbol",
          "data",
          "lastUpdated"
        ],
        "description": "Fundamental analysis response with time series data"
      },
      "ApiMarginLongPressureData": {
        "type": "object",
        "properties": {
          "date": {
            "type": "string",
            "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
          },
          "pressure": {
            "type": "number",
            "description": "(LongVol - ShrtVol) / N-day avg volume"
          },
          "longVol": {
            "type": "number",
            "minimum": 0
          },
          "shortVol": {
            "type": "number",
            "minimum": 0
          },
          "avgVolume": {
            "type": "number",
            "minimum": 0
          }
        },
        "required": [
          "date",
          "pressure",
          "longVol",
          "shortVol",
          "avgVolume"
        ],
        "description": "Margin long pressure data for a specific date"
      },
      "ApiMarginFlowPressureData": {
        "type": "object",
        "properties": {
          "date": {
            "type": "string",
            "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
          },
          "flowPressure": {
            "type": "number",
            "description": "Delta(LongVol - ShrtVol) / N-day avg volume"
          },
          "currentNetMargin": {
            "type": "number"
          },
          "previousNetMargin": {
            "type": "number",
            "nullable": true
          },
          "avgVolume": {
            "type": "number",
            "minimum": 0
          }
        },
        "required": [
          "date",
          "flowPressure",
          "currentNetMargin",
          "previousNetMargin",
          "avgVolume"
        ],
        "description": "Margin flow pressure data for a specific date"
      },
      "ApiMarginTurnoverDaysData": {
        "type": "object",
        "properties": {
          "date": {
            "type": "string",
            "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
          },
          "turnoverDays": {
            "type": "number",
            "minimum": 0,
            "description": "LongVol / N-day avg volume"
          },
          "longVol": {
            "type": "number",
            "minimum": 0
          },
          "avgVolume": {
            "type": "number",
            "minimum": 0
          }
        },
        "required": [
          "date",
          "turnoverDays",
          "longVol",
          "avgVolume"
        ],
        "description": "Margin turnover days data for a specific date"
      },
      "ApiMarginPressureIndicatorsResponse": {
        "type": "object",
        "properties": {
          "symbol": {
            "type": "string",
            "minLength": 4,
            "maxLength": 4
          },
          "averagePeriod": {
            "type": "integer",
            "minimum": 0,
            "exclusiveMinimum": true,
            "description": "Rolling average period in days"
          },
          "longPressure": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ApiMarginLongPressureData"
            }
          },
          "flowPressure": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ApiMarginFlowPressureData"
            }
          },
          "turnoverDays": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ApiMarginTurnoverDaysData"
            }
          },
          "lastUpdated": {
            "type": "string",
            "format": "date-time"
          }
        },
        "required": [
          "symbol",
          "averagePeriod",
          "longPressure",
          "flowPressure",
          "turnoverDays",
          "lastUpdated"
        ],
        "description": "Margin pressure indicators with configurable period"
      },
      "ApiMarginVolumeRatioData": {
        "type": "object",
        "properties": {
          "date": {
            "type": "string",
            "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
          },
          "ratio": {
            "type": "number",
            "minimum": 0
          },
          "weeklyAvgVolume": {
            "type": "number",
            "minimum": 0
          },
          "marginVolume": {
            "type": "number",
            "minimum": 0
          }
        },
        "required": [
          "date",
          "ratio",
          "weeklyAvgVolume",
          "marginVolume"
        ],
        "description": "Margin volume ratio data for a specific date"
      },
      "ApiMarginVolumeRatioResponse": {
        "type": "object",
        "properties": {
          "symbol": {
            "type": "string",
            "minLength": 4,
            "maxLength": 4
          },
          "longRatio": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ApiMarginVolumeRatioData"
            }
          },
          "shortRatio": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ApiMarginVolumeRatioData"
            }
          },
          "lastUpdated": {
            "type": "string",
            "format": "date-time"
          }
        },
        "required": [
          "symbol",
          "longRatio",
          "shortRatio",
          "lastUpdated"
        ],
        "description": "Long and short margin volume ratio data"
      },
      "PortfolioWeight": {
        "type": "object",
        "properties": {
          "code": {
            "type": "string",
            "description": "Stock code (4-digit)",
            "example": "7203"
          },
          "companyName": {
            "type": "string",
            "description": "Company name",
            "example": "„Éà„É®„ÇøËá™ÂãïËªä"
          },
          "weight": {
            "type": "number",
            "description": "Weight (0-1)",
            "example": 0.25
          },
          "latestPrice": {
            "type": "number",
            "description": "Latest stock price used for weight calculation",
            "example": 2500
          },
          "marketValue": {
            "type": "number",
            "description": "Current market value (quantity √ó latestPrice)",
            "example": 250000
          },
          "quantity": {
            "type": "number",
            "description": "Holding quantity",
            "example": 100
          }
        },
        "required": [
          "code",
          "companyName",
          "weight",
          "latestPrice",
          "marketValue",
          "quantity"
        ]
      },
      "PortfolioDateRange": {
        "type": "object",
        "properties": {
          "from": {
            "type": "string",
            "description": "Start date of analysis period (YYYY-MM-DD)",
            "example": "2024-01-02"
          },
          "to": {
            "type": "string",
            "description": "End date of analysis period (YYYY-MM-DD)",
            "example": "2024-12-19"
          }
        },
        "required": [
          "from",
          "to"
        ]
      },
      "ExcludedStock": {
        "type": "object",
        "properties": {
          "code": {
            "type": "string",
            "description": "Stock code (4-digit)",
            "example": "9999"
          },
          "companyName": {
            "type": "string",
            "description": "Company name",
            "example": "Example Corp"
          },
          "reason": {
            "type": "string",
            "description": "Reason for exclusion",
            "example": "Insufficient data points: 25 < 30"
          }
        },
        "required": [
          "code",
          "companyName",
          "reason"
        ]
      },
      "PortfolioFactorRegressionResponse": {
        "type": "object",
        "properties": {
          "portfolioId": {
            "type": "number",
            "description": "Portfolio ID",
            "example": 1
          },
          "portfolioName": {
            "type": "string",
            "description": "Portfolio name",
            "example": "My Portfolio"
          },
          "weights": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PortfolioWeight"
            },
            "description": "Weight breakdown for each stock"
          },
          "totalValue": {
            "type": "number",
            "description": "Total portfolio market value",
            "example": 1000000
          },
          "stockCount": {
            "type": "number",
            "description": "Number of stocks in portfolio",
            "example": 5
          },
          "includedStockCount": {
            "type": "number",
            "description": "Number of stocks included in analysis",
            "example": 4
          },
          "marketBeta": {
            "type": "number",
            "description": "Market beta (Œ≤m) from TOPIX regression",
            "example": 1.05
          },
          "marketRSquared": {
            "type": "number",
            "description": "R-squared from TOPIX regression (market exposure)",
            "example": 0.72
          },
          "sector17Matches": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/IndexMatch"
            },
            "description": "Top 3 matching TOPIX-17 sector indices"
          },
          "sector33Matches": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/IndexMatch"
            },
            "description": "Top 3 matching 33-sector indices"
          },
          "topixStyleMatches": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/IndexMatch"
            },
            "description": "Top 3 matching TOPIX size + Market + Style indices (excluding TOPIX 0000)"
          },
          "analysisDate": {
            "type": "string",
            "description": "Analysis date (YYYY-MM-DD)",
            "example": "2024-12-20"
          },
          "dataPoints": {
            "type": "number",
            "description": "Number of trading days used in analysis",
            "example": 252
          },
          "dateRange": {
            "$ref": "#/components/schemas/PortfolioDateRange"
          },
          "excludedStocks": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ExcludedStock"
            },
            "description": "Stocks excluded from analysis due to insufficient data"
          }
        },
        "required": [
          "portfolioId",
          "portfolioName",
          "weights",
          "totalValue",
          "stockCount",
          "includedStockCount",
          "marketBeta",
          "marketRSquared",
          "sector17Matches",
          "sector33Matches",
          "topixStyleMatches",
          "analysisDate",
          "dataPoints",
          "dateRange",
          "excludedStocks"
        ],
        "description": "Portfolio factor regression analysis result for risk decomposition"
      },
      "RankingItem": {
        "type": "object",
        "properties": {
          "rank": {
            "type": "integer",
            "description": "Rank position",
            "example": 1
          },
          "code": {
            "type": "string",
            "description": "Stock code",
            "example": "7203"
          },
          "companyName": {
            "type": "string",
            "description": "Company name",
            "example": "„Éà„É®„ÇøËá™ÂãïËªä"
          },
          "marketCode": {
            "type": "string",
            "description": "Market code",
            "example": "prime"
          },
          "sector33Name": {
            "type": "string",
            "description": "Sector name",
            "example": "Ëº∏ÈÄÅÁî®Ê©üÂô®"
          },
          "currentPrice": {
            "type": "number",
            "description": "Current stock price",
            "example": 2500
          },
          "volume": {
            "type": "number",
            "description": "Trading volume",
            "example": 10000000
          },
          "tradingValue": {
            "type": "number",
            "description": "Trading value (price * volume)",
            "example": 25000000000
          },
          "tradingValueAverage": {
            "type": "number",
            "description": "Average trading value over lookback period",
            "example": 24000000000
          },
          "previousPrice": {
            "type": "number",
            "description": "Previous day closing price",
            "example": 2480
          },
          "basePrice": {
            "type": "number",
            "description": "Base price for lookback calculation",
            "example": 2400
          },
          "changeAmount": {
            "type": "number",
            "description": "Price change amount",
            "example": 20
          },
          "changePercentage": {
            "type": "number",
            "description": "Price change percentage",
            "example": 0.81
          },
          "lookbackDays": {
            "type": "number",
            "description": "Lookback days used",
            "example": 5
          }
        },
        "required": [
          "rank",
          "code",
          "companyName",
          "marketCode",
          "sector33Name",
          "currentPrice",
          "volume"
        ],
        "description": "Single ranking entry"
      },
      "Rankings": {
        "type": "object",
        "properties": {
          "tradingValue": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RankingItem"
            },
            "description": "Top stocks by trading value"
          },
          "gainers": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RankingItem"
            },
            "description": "Top price gainers"
          },
          "losers": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RankingItem"
            },
            "description": "Top price losers"
          },
          "periodHigh": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RankingItem"
            },
            "description": "Stocks hitting N-day high"
          },
          "periodLow": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RankingItem"
            },
            "description": "Stocks hitting N-day low"
          }
        },
        "required": [
          "tradingValue",
          "gainers",
          "losers",
          "periodHigh",
          "periodLow"
        ],
        "description": "Collection of market rankings"
      },
      "MarketRankingResponse": {
        "type": "object",
        "properties": {
          "date": {
            "type": "string",
            "description": "Ranking date",
            "example": "2025-01-15"
          },
          "markets": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Markets included",
            "example": [
              "prime"
            ]
          },
          "lookbackDays": {
            "type": "integer",
            "description": "Lookback days used",
            "example": 1
          },
          "periodDays": {
            "type": "integer",
            "description": "Period days for high/low",
            "example": 250
          },
          "rankings": {
            "$ref": "#/components/schemas/Rankings"
          },
          "lastUpdated": {
            "type": "string",
            "format": "date-time",
            "description": "Response timestamp"
          }
        },
        "required": [
          "date",
          "markets",
          "lookbackDays",
          "periodDays",
          "rankings",
          "lastUpdated"
        ],
        "description": "Market ranking response with trading value, gainers, losers, and period high/low"
      },
      "ROEMetadata": {
        "type": "object",
        "properties": {
          "code": {
            "type": "string",
            "description": "Stock code",
            "example": "7203"
          },
          "periodType": {
            "type": "string",
            "description": "Period type (FY, Q1, Q2, Q3)",
            "example": "FY"
          },
          "periodEnd": {
            "type": "string",
            "description": "Period end date",
            "example": "2024-03-31"
          },
          "isConsolidated": {
            "type": "boolean",
            "description": "Whether data is consolidated",
            "example": true
          },
          "accountingStandard": {
            "type": "string",
            "nullable": true,
            "description": "Accounting standard",
            "example": "IFRS"
          },
          "isAnnualized": {
            "type": "boolean",
            "description": "Whether quarterly data is annualized",
            "example": false
          }
        },
        "required": [
          "code",
          "periodType",
          "periodEnd",
          "isConsolidated",
          "accountingStandard"
        ],
        "description": "Metadata for ROE calculation"
      },
      "ROEResultItem": {
        "type": "object",
        "properties": {
          "roe": {
            "type": "number",
            "description": "Return on Equity percentage",
            "example": 15.5
          },
          "netProfit": {
            "type": "number",
            "description": "Net profit in millions of yen",
            "example": 250000
          },
          "equity": {
            "type": "number",
            "description": "Shareholders' equity in millions of yen",
            "example": 1500000
          },
          "metadata": {
            "$ref": "#/components/schemas/ROEMetadata"
          }
        },
        "required": [
          "roe",
          "netProfit",
          "equity",
          "metadata"
        ],
        "description": "ROE calculation result for a single company"
      },
      "ROESummary": {
        "type": "object",
        "properties": {
          "averageROE": {
            "type": "number",
            "description": "Average ROE across all results",
            "example": 12.5
          },
          "maxROE": {
            "type": "number",
            "description": "Maximum ROE value",
            "example": 25
          },
          "minROE": {
            "type": "number",
            "description": "Minimum ROE value",
            "example": 5
          },
          "totalCompanies": {
            "type": "integer",
            "description": "Number of companies in results",
            "example": 50
          }
        },
        "required": [
          "averageROE",
          "maxROE",
          "minROE",
          "totalCompanies"
        ],
        "description": "Summary statistics for ROE analysis"
      },
      "ROEResponse": {
        "type": "object",
        "properties": {
          "results": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ROEResultItem"
            }
          },
          "summary": {
            "$ref": "#/components/schemas/ROESummary"
          },
          "lastUpdated": {
            "type": "string",
            "format": "date-time"
          }
        },
        "required": [
          "results",
          "summary",
          "lastUpdated"
        ],
        "description": "ROE analysis response with results and summary statistics"
      },
      "RangeBreakDetails": {
        "type": "object",
        "properties": {
          "breakDate": {
            "type": "string",
            "description": "Date of the breakout",
            "example": "2025-01-15"
          },
          "currentHigh": {
            "type": "number",
            "description": "Current high price",
            "example": 2600
          },
          "maxHighInLookback": {
            "type": "number",
            "description": "Maximum high in lookback period",
            "example": 2500
          },
          "breakPercentage": {
            "type": "number",
            "description": "Break percentage above lookback max",
            "example": 4
          },
          "volumeRatio": {
            "type": "number",
            "description": "Volume ratio (short/long MA)",
            "example": 2.1
          },
          "avgVolume20Days": {
            "type": "number",
            "description": "Average volume (short period)",
            "example": 1500000
          },
          "avgVolume100Days": {
            "type": "number",
            "description": "Average volume (long period)",
            "example": 700000
          }
        },
        "required": [
          "breakDate",
          "currentHigh",
          "maxHighInLookback",
          "breakPercentage",
          "volumeRatio",
          "avgVolume20Days",
          "avgVolume100Days"
        ]
      },
      "ScreeningDetails": {
        "type": "object",
        "properties": {
          "rangeBreak": {
            "$ref": "#/components/schemas/RangeBreakDetails"
          }
        }
      },
      "FuturePricePoint": {
        "type": "object",
        "nullable": true,
        "properties": {
          "date": {
            "type": "string",
            "description": "Date of the price point",
            "example": "2025-01-23"
          },
          "price": {
            "type": "number",
            "description": "Closing price",
            "example": 2680
          },
          "changePercent": {
            "type": "number",
            "description": "Percentage change from break date",
            "example": 3.08
          }
        },
        "required": [
          "date",
          "price",
          "changePercent"
        ],
        "description": "Price movement after 5 trading days"
      },
      "FutureReturns": {
        "type": "object",
        "properties": {
          "day5": {
            "$ref": "#/components/schemas/FuturePricePoint"
          },
          "day20": {
            "allOf": [
              {
                "$ref": "#/components/schemas/FuturePricePoint"
              },
              {
                "description": "Price movement after 20 trading days"
              }
            ]
          },
          "day60": {
            "allOf": [
              {
                "$ref": "#/components/schemas/FuturePricePoint"
              },
              {
                "description": "Price movement after 60 trading days"
              }
            ]
          }
        },
        "required": [
          "day5",
          "day20",
          "day60"
        ],
        "description": "Future price movements after the match date (only included for historical screening)"
      },
      "ScreeningResultItem": {
        "type": "object",
        "properties": {
          "stockCode": {
            "type": "string",
            "description": "Stock code",
            "example": "7203"
          },
          "companyName": {
            "type": "string",
            "description": "Company name",
            "example": "„Éà„É®„ÇøËá™ÂãïËªä"
          },
          "scaleCategory": {
            "type": "string",
            "description": "Scale category",
            "example": "TOPIX Large70"
          },
          "sector33Name": {
            "type": "string",
            "description": "Sector name",
            "example": "Ëº∏ÈÄÅÁî®Ê©üÂô®"
          },
          "screeningType": {
            "type": "string",
            "enum": [
              "rangeBreakFast",
              "rangeBreakSlow"
            ],
            "description": "Type of screening match",
            "example": "rangeBreakFast"
          },
          "matchedDate": {
            "type": "string",
            "description": "Date of the match",
            "example": "2025-01-15"
          },
          "details": {
            "$ref": "#/components/schemas/ScreeningDetails"
          },
          "futureReturns": {
            "$ref": "#/components/schemas/FutureReturns"
          }
        },
        "required": [
          "stockCode",
          "companyName",
          "screeningType",
          "matchedDate",
          "details"
        ]
      },
      "ScreeningTypeCounts": {
        "type": "object",
        "properties": {
          "rangeBreakFast": {
            "type": "integer",
            "description": "Range Break Fast matches",
            "example": 15
          },
          "rangeBreakSlow": {
            "type": "integer",
            "description": "Range Break Slow matches",
            "example": 10
          }
        },
        "required": [
          "rangeBreakFast",
          "rangeBreakSlow"
        ]
      },
      "ScreeningSummary": {
        "type": "object",
        "properties": {
          "totalStocksScreened": {
            "type": "integer",
            "description": "Total stocks screened",
            "example": 1500
          },
          "matchCount": {
            "type": "integer",
            "description": "Number of matches",
            "example": 25
          },
          "skippedCount": {
            "type": "integer",
            "description": "Stocks skipped (insufficient data)",
            "example": 50
          },
          "byScreeningType": {
            "$ref": "#/components/schemas/ScreeningTypeCounts"
          }
        },
        "required": [
          "totalStocksScreened",
          "matchCount",
          "skippedCount",
          "byScreeningType"
        ]
      },
      "MarketScreeningResponse": {
        "type": "object",
        "properties": {
          "results": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ScreeningResultItem"
            }
          },
          "summary": {
            "$ref": "#/components/schemas/ScreeningSummary"
          },
          "markets": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Markets screened",
            "example": [
              "prime"
            ]
          },
          "recentDays": {
            "type": "integer",
            "description": "Recent days setting",
            "example": 10
          },
          "referenceDate": {
            "type": "string",
            "description": "Reference date for historical screening (if specified)",
            "example": "2025-01-18"
          },
          "lastUpdated": {
            "type": "string",
            "format": "date-time",
            "description": "Response timestamp"
          }
        },
        "required": [
          "results",
          "summary",
          "markets",
          "recentDays",
          "lastUpdated"
        ],
        "description": "Stock screening results with summary statistics"
      },
      "SectorStockItem": {
        "type": "object",
        "properties": {
          "rank": {
            "type": "integer",
            "description": "Rank position",
            "example": 1
          },
          "code": {
            "type": "string",
            "description": "Stock code",
            "example": "7203"
          },
          "companyName": {
            "type": "string",
            "description": "Company name",
            "example": "„Éà„É®„ÇøËá™ÂãïËªä"
          },
          "marketCode": {
            "type": "string",
            "description": "Market code",
            "example": "prime"
          },
          "sector33Name": {
            "type": "string",
            "description": "Sector name",
            "example": "Ëº∏ÈÄÅÁî®Ê©üÂô®"
          },
          "currentPrice": {
            "type": "number",
            "description": "Current stock price",
            "example": 2500
          },
          "volume": {
            "type": "number",
            "description": "Trading volume",
            "example": 10000000
          },
          "tradingValue": {
            "type": "number",
            "description": "Trading value (price * volume)",
            "example": 25000000000
          },
          "basePrice": {
            "type": "number",
            "description": "Base price for lookback calculation",
            "example": 2400
          },
          "changeAmount": {
            "type": "number",
            "description": "Price change amount",
            "example": 100
          },
          "changePercentage": {
            "type": "number",
            "description": "Price change percentage",
            "example": 4.17
          },
          "lookbackDays": {
            "type": "number",
            "description": "Lookback days used",
            "example": 5
          }
        },
        "required": [
          "rank",
          "code",
          "companyName",
          "marketCode",
          "sector33Name",
          "currentPrice",
          "volume"
        ]
      },
      "SectorStocksResponse": {
        "type": "object",
        "properties": {
          "sector33Name": {
            "type": "string",
            "description": "Sector 33 name filter used"
          },
          "sector17Name": {
            "type": "string",
            "description": "Sector 17 name filter used"
          },
          "markets": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Markets included",
            "example": [
              "prime",
              "standard"
            ]
          },
          "lookbackDays": {
            "type": "integer",
            "description": "Lookback days used",
            "example": 5
          },
          "sortBy": {
            "type": "string",
            "description": "Sort field used",
            "example": "tradingValue"
          },
          "sortOrder": {
            "type": "string",
            "description": "Sort order used",
            "example": "desc"
          },
          "stocks": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SectorStockItem"
            }
          },
          "lastUpdated": {
            "type": "string",
            "format": "date-time",
            "description": "Response timestamp"
          }
        },
        "required": [
          "markets",
          "lookbackDays",
          "sortBy",
          "sortOrder",
          "stocks",
          "lastUpdated"
        ]
      },
      "PortfolioSummaryResponse": {
        "type": "object",
        "properties": {
          "id": {
            "type": "number",
            "example": 1,
            "description": "Portfolio ID"
          },
          "name": {
            "type": "string",
            "example": "My Portfolio",
            "description": "Portfolio name"
          },
          "description": {
            "type": "string",
            "example": "Long-term holdings",
            "description": "Portfolio description"
          },
          "stockCount": {
            "type": "number",
            "example": 5,
            "description": "Number of different stocks in portfolio"
          },
          "totalShares": {
            "type": "number",
            "example": 500,
            "description": "Total number of shares across all stocks"
          },
          "createdAt": {
            "type": "string",
            "example": "2024-01-01T00:00:00.000Z",
            "description": "Creation timestamp"
          },
          "updatedAt": {
            "type": "string",
            "example": "2024-01-01T00:00:00.000Z",
            "description": "Last update timestamp"
          }
        },
        "required": [
          "id",
          "name",
          "stockCount",
          "totalShares",
          "createdAt",
          "updatedAt"
        ]
      },
      "ListPortfoliosResponse": {
        "type": "object",
        "properties": {
          "portfolios": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PortfolioSummaryResponse"
            },
            "description": "List of portfolios with summary statistics"
          }
        },
        "required": [
          "portfolios"
        ]
      },
      "PortfolioResponse": {
        "type": "object",
        "properties": {
          "id": {
            "type": "number",
            "example": 1,
            "description": "Portfolio ID"
          },
          "name": {
            "type": "string",
            "example": "My Portfolio",
            "description": "Portfolio name"
          },
          "description": {
            "type": "string",
            "example": "Long-term holdings",
            "description": "Portfolio description"
          },
          "createdAt": {
            "type": "string",
            "example": "2024-01-01T00:00:00.000Z",
            "description": "Creation timestamp"
          },
          "updatedAt": {
            "type": "string",
            "example": "2024-01-01T00:00:00.000Z",
            "description": "Last update timestamp"
          }
        },
        "required": [
          "id",
          "name",
          "createdAt",
          "updatedAt"
        ]
      },
      "CreatePortfolioRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "minLength": 1,
            "example": "My Portfolio",
            "description": "Portfolio name (must be unique)"
          },
          "description": {
            "type": "string",
            "example": "Long-term holdings",
            "description": "Portfolio description"
          }
        },
        "required": [
          "name"
        ]
      },
      "PortfolioItemResponse": {
        "type": "object",
        "properties": {
          "id": {
            "type": "number",
            "example": 1,
            "description": "Item ID"
          },
          "portfolioId": {
            "type": "number",
            "example": 1,
            "description": "Portfolio ID"
          },
          "code": {
            "type": "string",
            "example": "7203",
            "description": "Stock code"
          },
          "companyName": {
            "type": "string",
            "example": "Toyota Motor",
            "description": "Company name"
          },
          "quantity": {
            "type": "number",
            "example": 100,
            "description": "Number of shares"
          },
          "purchasePrice": {
            "type": "number",
            "example": 2500,
            "description": "Purchase price per share"
          },
          "purchaseDate": {
            "type": "string",
            "example": "2024-01-01",
            "description": "Purchase date"
          },
          "account": {
            "type": "string",
            "example": "NISA",
            "description": "Account type"
          },
          "notes": {
            "type": "string",
            "example": "Blue chip stock",
            "description": "Additional notes"
          },
          "createdAt": {
            "type": "string",
            "example": "2024-01-01T00:00:00.000Z",
            "description": "Creation timestamp"
          },
          "updatedAt": {
            "type": "string",
            "example": "2024-01-01T00:00:00.000Z",
            "description": "Last update timestamp"
          }
        },
        "required": [
          "id",
          "portfolioId",
          "code",
          "companyName",
          "quantity",
          "purchasePrice",
          "purchaseDate",
          "createdAt",
          "updatedAt"
        ]
      },
      "PortfolioWithItemsResponse": {
        "type": "object",
        "properties": {
          "id": {
            "type": "number",
            "example": 1,
            "description": "Portfolio ID"
          },
          "name": {
            "type": "string",
            "example": "My Portfolio",
            "description": "Portfolio name"
          },
          "description": {
            "type": "string",
            "example": "Long-term holdings",
            "description": "Portfolio description"
          },
          "createdAt": {
            "type": "string",
            "example": "2024-01-01T00:00:00.000Z",
            "description": "Creation timestamp"
          },
          "updatedAt": {
            "type": "string",
            "example": "2024-01-01T00:00:00.000Z",
            "description": "Last update timestamp"
          },
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PortfolioItemResponse"
            },
            "description": "Portfolio items"
          }
        },
        "required": [
          "id",
          "name",
          "createdAt",
          "updatedAt",
          "items"
        ]
      },
      "UpdatePortfolioRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "minLength": 1,
            "example": "Updated Portfolio",
            "description": "Updated portfolio name"
          },
          "description": {
            "type": "string",
            "example": "Updated description",
            "description": "Updated portfolio description"
          }
        }
      },
      "DeleteSuccessResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "example": true,
            "description": "Operation success status"
          },
          "message": {
            "type": "string",
            "example": "Portfolio deleted successfully",
            "description": "Success message"
          }
        },
        "required": [
          "success",
          "message"
        ]
      },
      "CreatePortfolioItemRequest": {
        "type": "object",
        "properties": {
          "code": {
            "type": "string",
            "pattern": "^\\d[0-9A-Z]\\d[0-9A-Z]$",
            "example": "7203",
            "description": "Stock code (4 characters)"
          },
          "companyName": {
            "type": "string",
            "minLength": 1,
            "example": "Toyota Motor",
            "description": "Company name (if not provided, will be fetched from JQuants API)"
          },
          "quantity": {
            "type": "integer",
            "minimum": 0,
            "exclusiveMinimum": true,
            "example": 100,
            "description": "Number of shares"
          },
          "purchasePrice": {
            "type": "number",
            "minimum": 0,
            "exclusiveMinimum": true,
            "example": 2500,
            "description": "Purchase price per share"
          },
          "purchaseDate": {
            "type": "string",
            "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
            "example": "2024-01-01",
            "description": "Purchase date (YYYY-MM-DD)"
          },
          "account": {
            "type": "string",
            "example": "NISA",
            "description": "Account type (e.g., NISA, iDeCo)"
          },
          "notes": {
            "type": "string",
            "example": "Blue chip stock",
            "description": "Additional notes"
          }
        },
        "required": [
          "code",
          "quantity",
          "purchasePrice",
          "purchaseDate"
        ]
      },
      "UpdatePortfolioItemRequest": {
        "type": "object",
        "properties": {
          "quantity": {
            "type": "integer",
            "minimum": 0,
            "exclusiveMinimum": true,
            "example": 150,
            "description": "Updated number of shares"
          },
          "purchasePrice": {
            "type": "number",
            "minimum": 0,
            "exclusiveMinimum": true,
            "example": 2600,
            "description": "Updated purchase price per share"
          },
          "purchaseDate": {
            "type": "string",
            "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
            "example": "2024-02-01",
            "description": "Updated purchase date (YYYY-MM-DD)"
          },
          "account": {
            "type": "string",
            "example": "iDeCo",
            "description": "Updated account type"
          },
          "notes": {
            "type": "string",
            "example": "Updated notes",
            "description": "Updated notes"
          }
        }
      },
      "PortfolioItemDeletedResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "example": true,
            "description": "Operation success status"
          },
          "message": {
            "type": "string",
            "example": "Stock removed successfully",
            "description": "Success message"
          },
          "deletedItem": {
            "allOf": [
              {
                "$ref": "#/components/schemas/PortfolioItemResponse"
              },
              {
                "description": "The deleted portfolio item details"
              }
            ]
          }
        },
        "required": [
          "success",
          "message",
          "deletedItem"
        ]
      },
      "PortfolioCodesResponse": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "example": "My Portfolio",
            "description": "Portfolio name"
          },
          "codes": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "example": [
              "7203",
              "9984",
              "6758"
            ],
            "description": "List of stock codes in the portfolio"
          }
        },
        "required": [
          "name",
          "codes"
        ]
      },
      "PortfolioSummary": {
        "type": "object",
        "properties": {
          "totalCost": {
            "type": "number",
            "description": "Total acquisition cost",
            "example": 2500000
          },
          "currentValue": {
            "type": "number",
            "description": "Current market value",
            "example": 2750000
          },
          "totalPnL": {
            "type": "number",
            "description": "Total unrealized P&L",
            "example": 250000
          },
          "returnRate": {
            "type": "number",
            "description": "Return rate as decimal (e.g., 0.10 = 10%)",
            "example": 0.1
          }
        },
        "required": [
          "totalCost",
          "currentValue",
          "totalPnL",
          "returnRate"
        ],
        "description": "Portfolio summary metrics"
      },
      "HoldingPerformance": {
        "type": "object",
        "properties": {
          "code": {
            "type": "string",
            "description": "Stock code",
            "example": "7203"
          },
          "companyName": {
            "type": "string",
            "description": "Company name",
            "example": "„Éà„É®„ÇøËá™ÂãïËªä"
          },
          "quantity": {
            "type": "number",
            "description": "Holding quantity",
            "example": 100
          },
          "purchasePrice": {
            "type": "number",
            "description": "Purchase price per share",
            "example": 2500
          },
          "currentPrice": {
            "type": "number",
            "description": "Current price per share",
            "example": 2750
          },
          "cost": {
            "type": "number",
            "description": "Total cost (purchasePrice x quantity)",
            "example": 250000
          },
          "marketValue": {
            "type": "number",
            "description": "Current market value (currentPrice x quantity)",
            "example": 275000
          },
          "pnl": {
            "type": "number",
            "description": "Unrealized P&L",
            "example": 25000
          },
          "returnRate": {
            "type": "number",
            "description": "Return rate as decimal",
            "example": 0.1
          },
          "weight": {
            "type": "number",
            "description": "Weight in portfolio (0-1)",
            "example": 0.25
          },
          "purchaseDate": {
            "type": "string",
            "description": "Purchase date (YYYY-MM-DD)",
            "example": "2024-01-15"
          },
          "account": {
            "type": "string",
            "description": "Account name",
            "example": "NISA"
          }
        },
        "required": [
          "code",
          "companyName",
          "quantity",
          "purchasePrice",
          "currentPrice",
          "cost",
          "marketValue",
          "pnl",
          "returnRate",
          "weight",
          "purchaseDate"
        ]
      },
      "PerformanceDataPoint": {
        "type": "object",
        "properties": {
          "date": {
            "type": "string",
            "description": "Date (YYYY-MM-DD)",
            "example": "2024-12-20"
          },
          "dailyReturn": {
            "type": "number",
            "description": "Daily log return",
            "example": 0.005
          },
          "cumulativeReturn": {
            "type": "number",
            "description": "Cumulative log return from start",
            "example": 0.085
          }
        },
        "required": [
          "date",
          "dailyReturn",
          "cumulativeReturn"
        ]
      },
      "BenchmarkMetrics": {
        "type": "object",
        "nullable": true,
        "properties": {
          "code": {
            "type": "string",
            "description": "Benchmark index code",
            "example": "0000"
          },
          "name": {
            "type": "string",
            "description": "Benchmark name",
            "example": "TOPIX"
          },
          "beta": {
            "type": "number",
            "description": "Portfolio beta vs benchmark",
            "example": 1.15
          },
          "alpha": {
            "type": "number",
            "description": "Jensen's alpha (annualized)",
            "example": 0.02
          },
          "correlation": {
            "type": "number",
            "description": "Correlation coefficient",
            "example": 0.85
          },
          "rSquared": {
            "type": "number",
            "description": "R-squared from regression",
            "example": 0.72
          },
          "benchmarkReturn": {
            "type": "number",
            "description": "Benchmark cumulative return",
            "example": 0.06
          },
          "relativeReturn": {
            "type": "number",
            "description": "Relative return (portfolio - benchmark)",
            "example": 0.025
          }
        },
        "required": [
          "code",
          "name",
          "beta",
          "alpha",
          "correlation",
          "rSquared",
          "benchmarkReturn",
          "relativeReturn"
        ],
        "description": "Benchmark comparison metrics (null if insufficient data)"
      },
      "BenchmarkDataPoint": {
        "type": "object",
        "properties": {
          "date": {
            "type": "string",
            "description": "Date (YYYY-MM-DD)",
            "example": "2024-12-20"
          },
          "portfolioReturn": {
            "type": "number",
            "description": "Portfolio cumulative return",
            "example": 0.085
          },
          "benchmarkReturn": {
            "type": "number",
            "description": "Benchmark cumulative return",
            "example": 0.06
          }
        },
        "required": [
          "date",
          "portfolioReturn",
          "benchmarkReturn"
        ]
      },
      "PortfolioPerformanceResponse": {
        "type": "object",
        "properties": {
          "portfolioId": {
            "type": "number",
            "description": "Portfolio ID",
            "example": 1
          },
          "portfolioName": {
            "type": "string",
            "description": "Portfolio name",
            "example": "My Portfolio"
          },
          "portfolioDescription": {
            "type": "string",
            "description": "Portfolio description"
          },
          "summary": {
            "$ref": "#/components/schemas/PortfolioSummary"
          },
          "holdings": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/HoldingPerformance"
            },
            "description": "Per-holding performance metrics"
          },
          "timeSeries": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PerformanceDataPoint"
            },
            "description": "Portfolio performance time series"
          },
          "benchmark": {
            "$ref": "#/components/schemas/BenchmarkMetrics"
          },
          "benchmarkTimeSeries": {
            "type": "array",
            "nullable": true,
            "items": {
              "$ref": "#/components/schemas/BenchmarkDataPoint"
            },
            "description": "Portfolio vs benchmark time series (null if insufficient data)"
          },
          "analysisDate": {
            "type": "string",
            "description": "Analysis date (YYYY-MM-DD)",
            "example": "2024-12-20"
          },
          "dateRange": {
            "type": "object",
            "nullable": true,
            "properties": {
              "from": {
                "type": "string",
                "description": "Start date of time series",
                "example": "2024-01-02"
              },
              "to": {
                "type": "string",
                "description": "End date of time series",
                "example": "2024-12-19"
              }
            },
            "required": [
              "from",
              "to"
            ],
            "description": "Date range of time series analysis"
          },
          "dataPoints": {
            "type": "number",
            "description": "Number of data points in time series",
            "example": 252
          },
          "warnings": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Warnings or notes about the analysis"
          }
        },
        "required": [
          "portfolioId",
          "portfolioName",
          "summary",
          "holdings",
          "timeSeries",
          "benchmark",
          "benchmarkTimeSeries",
          "analysisDate",
          "dateRange",
          "dataPoints",
          "warnings"
        ],
        "description": "Portfolio performance with P&L and benchmark comparison"
      },
      "WatchlistSummaryResponse": {
        "type": "object",
        "properties": {
          "id": {
            "type": "number",
            "example": 1,
            "description": "Watchlist ID"
          },
          "name": {
            "type": "string",
            "example": "Tech Stocks",
            "description": "Watchlist name"
          },
          "description": {
            "type": "string",
            "example": "Technology sector stocks",
            "description": "Description"
          },
          "stockCount": {
            "type": "number",
            "example": 5,
            "description": "Number of stocks in watchlist"
          },
          "createdAt": {
            "type": "string",
            "example": "2024-01-01T00:00:00.000Z",
            "description": "Creation timestamp"
          },
          "updatedAt": {
            "type": "string",
            "example": "2024-01-01T00:00:00.000Z",
            "description": "Last update timestamp"
          }
        },
        "required": [
          "id",
          "name",
          "stockCount",
          "createdAt",
          "updatedAt"
        ]
      },
      "ListWatchlistsResponse": {
        "type": "object",
        "properties": {
          "watchlists": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/WatchlistSummaryResponse"
            },
            "description": "List of watchlists with summary statistics"
          }
        },
        "required": [
          "watchlists"
        ]
      },
      "WatchlistResponse": {
        "type": "object",
        "properties": {
          "id": {
            "type": "number",
            "example": 1,
            "description": "Watchlist ID"
          },
          "name": {
            "type": "string",
            "example": "Tech Stocks",
            "description": "Watchlist name"
          },
          "description": {
            "type": "string",
            "example": "Technology sector stocks",
            "description": "Description"
          },
          "createdAt": {
            "type": "string",
            "example": "2024-01-01T00:00:00.000Z",
            "description": "Creation timestamp"
          },
          "updatedAt": {
            "type": "string",
            "example": "2024-01-01T00:00:00.000Z",
            "description": "Last update timestamp"
          }
        },
        "required": [
          "id",
          "name",
          "createdAt",
          "updatedAt"
        ]
      },
      "CreateWatchlistRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "minLength": 1,
            "example": "Tech Stocks",
            "description": "Watchlist name (must be unique)"
          },
          "description": {
            "type": "string",
            "example": "Technology sector stocks to monitor",
            "description": "Watchlist description"
          }
        },
        "required": [
          "name"
        ]
      },
      "WatchlistItemResponse": {
        "type": "object",
        "properties": {
          "id": {
            "type": "number",
            "example": 1,
            "description": "Item ID"
          },
          "watchlistId": {
            "type": "number",
            "example": 1,
            "description": "Watchlist ID"
          },
          "code": {
            "type": "string",
            "example": "7203",
            "description": "Stock code"
          },
          "companyName": {
            "type": "string",
            "example": "Toyota Motor",
            "description": "Company name"
          },
          "memo": {
            "type": "string",
            "example": "Watching for breakout",
            "description": "Memo"
          },
          "createdAt": {
            "type": "string",
            "example": "2024-01-01T00:00:00.000Z",
            "description": "Creation timestamp"
          }
        },
        "required": [
          "id",
          "watchlistId",
          "code",
          "companyName",
          "createdAt"
        ]
      },
      "WatchlistWithItemsResponse": {
        "type": "object",
        "properties": {
          "id": {
            "type": "number",
            "example": 1,
            "description": "Watchlist ID"
          },
          "name": {
            "type": "string",
            "example": "Tech Stocks",
            "description": "Watchlist name"
          },
          "description": {
            "type": "string",
            "example": "Technology sector stocks",
            "description": "Description"
          },
          "createdAt": {
            "type": "string",
            "example": "2024-01-01T00:00:00.000Z",
            "description": "Creation timestamp"
          },
          "updatedAt": {
            "type": "string",
            "example": "2024-01-01T00:00:00.000Z",
            "description": "Last update timestamp"
          },
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/WatchlistItemResponse"
            },
            "description": "Watchlist items"
          }
        },
        "required": [
          "id",
          "name",
          "createdAt",
          "updatedAt",
          "items"
        ]
      },
      "UpdateWatchlistRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "minLength": 1,
            "example": "Updated Watchlist",
            "description": "Updated watchlist name"
          },
          "description": {
            "type": "string",
            "example": "Updated description",
            "description": "Updated watchlist description"
          }
        }
      },
      "WatchlistDeleteSuccessResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "example": true,
            "description": "Operation success status"
          },
          "message": {
            "type": "string",
            "example": "Watchlist deleted successfully",
            "description": "Success message"
          }
        },
        "required": [
          "success",
          "message"
        ]
      },
      "CreateWatchlistItemRequest": {
        "type": "object",
        "properties": {
          "code": {
            "type": "string",
            "pattern": "^\\d[0-9A-Z]\\d[0-9A-Z]$",
            "example": "7203",
            "description": "Stock code (4 characters)"
          },
          "companyName": {
            "type": "string",
            "minLength": 1,
            "example": "Toyota Motor",
            "description": "Company name (if not provided, will be fetched from market database)"
          },
          "memo": {
            "type": "string",
            "example": "Watching for breakout",
            "description": "Optional memo"
          }
        },
        "required": [
          "code"
        ]
      },
      "WatchlistStockPrice": {
        "type": "object",
        "properties": {
          "code": {
            "type": "string",
            "example": "7203",
            "description": "Stock code"
          },
          "close": {
            "type": "number",
            "example": 2500,
            "description": "Latest close price"
          },
          "prevClose": {
            "type": "number",
            "nullable": true,
            "example": 2450,
            "description": "Previous close price"
          },
          "changePercent": {
            "type": "number",
            "nullable": true,
            "example": 2.04,
            "description": "Change percentage"
          },
          "volume": {
            "type": "number",
            "example": 1500000,
            "description": "Trading volume"
          },
          "date": {
            "type": "string",
            "example": "2024-01-15",
            "description": "Data date"
          }
        },
        "required": [
          "code",
          "close",
          "prevClose",
          "changePercent",
          "volume",
          "date"
        ]
      },
      "WatchlistPricesResponse": {
        "type": "object",
        "properties": {
          "prices": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/WatchlistStockPrice"
            },
            "description": "Stock prices for watchlist items"
          }
        },
        "required": [
          "prices"
        ]
      },
      "StockRefetchResult": {
        "type": "object",
        "properties": {
          "code": {
            "type": "string",
            "description": "Stock code",
            "example": "7203"
          },
          "success": {
            "type": "boolean",
            "description": "Whether refetch was successful",
            "example": true
          },
          "recordsFetched": {
            "type": "integer",
            "description": "Number of records fetched from API",
            "example": 2500
          },
          "recordsStored": {
            "type": "integer",
            "description": "Number of records stored in database",
            "example": 252
          },
          "error": {
            "type": "string",
            "description": "Error message if failed",
            "example": "API call failed"
          }
        },
        "required": [
          "code",
          "success",
          "recordsFetched",
          "recordsStored"
        ]
      },
      "MarketRefreshResponse": {
        "type": "object",
        "properties": {
          "totalStocks": {
            "type": "integer",
            "description": "Total number of stocks processed",
            "example": 3
          },
          "successCount": {
            "type": "integer",
            "description": "Number of successful refreshes",
            "example": 3
          },
          "failedCount": {
            "type": "integer",
            "description": "Number of failed refreshes",
            "example": 0
          },
          "totalApiCalls": {
            "type": "integer",
            "description": "Total API calls made",
            "example": 3
          },
          "totalRecordsStored": {
            "type": "integer",
            "description": "Total records stored",
            "example": 756
          },
          "results": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/StockRefetchResult"
            },
            "description": "Individual stock results"
          },
          "errors": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "List of error messages",
            "example": []
          },
          "lastUpdated": {
            "type": "string",
            "format": "date-time",
            "description": "Response timestamp"
          }
        },
        "required": [
          "totalStocks",
          "successCount",
          "failedCount",
          "totalApiCalls",
          "totalRecordsStored",
          "results",
          "errors",
          "lastUpdated"
        ],
        "description": "Result of refreshing stock historical data"
      },
      "MarketRefreshRequest": {
        "type": "object",
        "properties": {
          "codes": {
            "type": "array",
            "items": {
              "type": "string",
              "minLength": 1,
              "maxLength": 10
            },
            "minItems": 1,
            "maxItems": 50,
            "description": "Stock codes to refresh (1-50 codes)",
            "example": [
              "7203",
              "6758",
              "9984"
            ]
          }
        },
        "required": [
          "codes"
        ]
      },
      "TopixStats": {
        "type": "object",
        "properties": {
          "count": {
            "type": "number",
            "description": "Number of TOPIX records",
            "example": 294
          },
          "dateRange": {
            "allOf": [
              {
                "$ref": "#/components/schemas/DateRange"
              },
              {
                "nullable": true,
                "properties": {
                  "min": {
                    "type": "string",
                    "description": "Start date (YYYY-MM-DD)",
                    "example": "2024-01-01"
                  },
                  "max": {
                    "type": "string",
                    "description": "End date (YYYY-MM-DD)",
                    "example": "2024-12-31"
                  }
                },
                "required": [
                  "min",
                  "max"
                ]
              }
            ]
          }
        },
        "required": [
          "count",
          "dateRange"
        ]
      },
      "StocksStats": {
        "type": "object",
        "properties": {
          "total": {
            "type": "number",
            "description": "Total number of stocks",
            "example": 1800
          },
          "byMarket": {
            "type": "object",
            "additionalProperties": {
              "type": "number"
            },
            "description": "Number of stocks by market",
            "example": {
              "prime": 1200,
              "standard": 600
            }
          }
        },
        "required": [
          "total",
          "byMarket"
        ]
      },
      "StockDataStats": {
        "type": "object",
        "properties": {
          "count": {
            "type": "number",
            "description": "Total stock data records",
            "example": 933977
          },
          "dateCount": {
            "type": "number",
            "description": "Number of unique dates",
            "example": 294
          },
          "dateRange": {
            "allOf": [
              {
                "$ref": "#/components/schemas/DateRange"
              },
              {
                "nullable": true,
                "properties": {
                  "min": {
                    "type": "string",
                    "description": "Start date (YYYY-MM-DD)",
                    "example": "2024-01-01"
                  },
                  "max": {
                    "type": "string",
                    "description": "End date (YYYY-MM-DD)",
                    "example": "2024-12-31"
                  }
                },
                "required": [
                  "min",
                  "max"
                ]
              }
            ]
          },
          "averageStocksPerDay": {
            "type": "number",
            "description": "Average stocks per trading day",
            "example": 3177
          }
        },
        "required": [
          "count",
          "dateCount",
          "dateRange",
          "averageStocksPerDay"
        ]
      },
      "IndicesStats": {
        "type": "object",
        "properties": {
          "masterCount": {
            "type": "number",
            "description": "Number of index definitions",
            "example": 52
          },
          "dataCount": {
            "type": "number",
            "description": "Total index data records",
            "example": 15288
          },
          "dateCount": {
            "type": "number",
            "description": "Number of unique dates",
            "example": 294
          },
          "dateRange": {
            "allOf": [
              {
                "$ref": "#/components/schemas/DateRange"
              },
              {
                "nullable": true,
                "properties": {
                  "min": {
                    "type": "string",
                    "description": "Start date (YYYY-MM-DD)",
                    "example": "2024-01-01"
                  },
                  "max": {
                    "type": "string",
                    "description": "End date (YYYY-MM-DD)",
                    "example": "2024-12-31"
                  }
                },
                "required": [
                  "min",
                  "max"
                ]
              }
            ]
          },
          "byCategory": {
            "type": "object",
            "additionalProperties": {
              "type": "number"
            },
            "description": "Number of indices by category",
            "example": {
              "topix": 1,
              "sector33": 33,
              "sector17": 17,
              "market": 1
            }
          }
        },
        "required": [
          "masterCount",
          "dataCount",
          "dateCount",
          "dateRange",
          "byCategory"
        ]
      },
      "MarketStatsResponse": {
        "type": "object",
        "properties": {
          "initialized": {
            "type": "boolean",
            "description": "Whether the database is initialized",
            "example": true
          },
          "lastSync": {
            "type": "string",
            "nullable": true,
            "description": "Last sync timestamp",
            "example": "2024-12-19T10:00:00Z"
          },
          "databaseSize": {
            "type": "number",
            "description": "Database file size in bytes",
            "example": 104857600
          },
          "topix": {
            "$ref": "#/components/schemas/TopixStats"
          },
          "stocks": {
            "$ref": "#/components/schemas/StocksStats"
          },
          "stockData": {
            "$ref": "#/components/schemas/StockDataStats"
          },
          "indices": {
            "$ref": "#/components/schemas/IndicesStats"
          },
          "lastUpdated": {
            "type": "string",
            "format": "date-time",
            "description": "Response timestamp"
          }
        },
        "required": [
          "initialized",
          "lastSync",
          "databaseSize",
          "topix",
          "stocks",
          "stockData",
          "indices",
          "lastUpdated"
        ],
        "description": "Market database statistics"
      },
      "CreateSyncJobResponse": {
        "type": "object",
        "properties": {
          "jobId": {
            "type": "string",
            "format": "uuid",
            "description": "Created job ID",
            "example": "123e4567-e89b-12d3-a456-426614174000"
          },
          "status": {
            "type": "string",
            "enum": [
              "pending",
              "running",
              "completed",
              "failed",
              "cancelled"
            ],
            "description": "Current job status",
            "example": "running"
          },
          "mode": {
            "type": "string",
            "enum": [
              "auto",
              "initial",
              "incremental",
              "indices-only"
            ],
            "description": "Sync mode: auto (detect based on database state), initial (2 years), incremental, or indices-only (52 API calls)",
            "example": "auto"
          },
          "estimatedApiCalls": {
            "type": "integer",
            "description": "Estimated API calls",
            "example": 252
          },
          "message": {
            "type": "string",
            "description": "Status message",
            "example": "Sync job started"
          }
        },
        "required": [
          "jobId",
          "status",
          "mode",
          "estimatedApiCalls",
          "message"
        ],
        "description": "Response when creating a new sync job"
      },
      "MarketSyncRequest": {
        "type": "object",
        "properties": {
          "mode": {
            "type": "string",
            "enum": [
              "auto",
              "initial",
              "incremental",
              "indices-only"
            ],
            "default": "auto",
            "description": "Sync mode (default: auto)",
            "example": "auto"
          }
        }
      },
      "JobProgress": {
        "type": "object",
        "properties": {
          "stage": {
            "type": "string",
            "description": "Current stage name",
            "example": "Fetching daily quotes"
          },
          "current": {
            "type": "integer",
            "description": "Current progress count",
            "example": 50
          },
          "total": {
            "type": "integer",
            "description": "Total items to process",
            "example": 252
          },
          "percentage": {
            "type": "number",
            "description": "Progress percentage",
            "example": 19.84
          },
          "message": {
            "type": "string",
            "description": "Progress message",
            "example": "Processing 2024-01-15"
          }
        },
        "required": [
          "stage",
          "current",
          "total",
          "percentage",
          "message"
        ]
      },
      "SyncJobResult": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Whether sync was successful",
            "example": true
          },
          "totalApiCalls": {
            "type": "integer",
            "description": "Total API calls made",
            "example": 252
          },
          "stocksUpdated": {
            "type": "integer",
            "description": "Number of stocks updated",
            "example": 1800
          },
          "datesProcessed": {
            "type": "integer",
            "description": "Number of dates processed",
            "example": 250
          },
          "failedDates": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Failed dates (YYYY-MM-DD format)",
            "example": []
          },
          "errors": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Error messages",
            "example": []
          }
        },
        "required": [
          "success",
          "totalApiCalls",
          "stocksUpdated",
          "datesProcessed",
          "failedDates",
          "errors"
        ]
      },
      "SyncJobResponse": {
        "type": "object",
        "properties": {
          "jobId": {
            "type": "string",
            "format": "uuid",
            "description": "Unique job identifier",
            "example": "123e4567-e89b-12d3-a456-426614174000"
          },
          "status": {
            "type": "string",
            "enum": [
              "pending",
              "running",
              "completed",
              "failed",
              "cancelled"
            ],
            "description": "Current job status",
            "example": "running"
          },
          "mode": {
            "type": "string",
            "enum": [
              "auto",
              "initial",
              "incremental",
              "indices-only"
            ],
            "description": "Sync mode: auto (detect based on database state), initial (2 years), incremental, or indices-only (52 API calls)",
            "example": "auto"
          },
          "progress": {
            "$ref": "#/components/schemas/JobProgress"
          },
          "result": {
            "$ref": "#/components/schemas/SyncJobResult"
          },
          "startedAt": {
            "type": "string",
            "format": "date-time",
            "description": "Job start time"
          },
          "completedAt": {
            "type": "string",
            "format": "date-time",
            "description": "Job completion time"
          },
          "error": {
            "type": "string",
            "description": "Error message if failed"
          }
        },
        "required": [
          "jobId",
          "status",
          "mode",
          "startedAt"
        ],
        "description": "Sync job status and progress"
      },
      "CancelJobResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Whether cancellation was successful",
            "example": true
          },
          "jobId": {
            "type": "string",
            "format": "uuid",
            "description": "Cancelled job ID"
          },
          "message": {
            "type": "string",
            "description": "Status message",
            "example": "Job cancelled successfully"
          }
        },
        "required": [
          "success",
          "jobId",
          "message"
        ]
      },
      "TopixInfo": {
        "type": "object",
        "properties": {
          "count": {
            "type": "integer",
            "description": "Number of TOPIX data points",
            "example": 252
          },
          "dateRange": {
            "type": "object",
            "nullable": true,
            "properties": {
              "min": {
                "type": "string",
                "description": "Earliest date",
                "example": "2024-01-01"
              },
              "max": {
                "type": "string",
                "description": "Latest date",
                "example": "2025-01-15"
              }
            },
            "required": [
              "min",
              "max"
            ]
          }
        },
        "required": [
          "count",
          "dateRange"
        ]
      },
      "StocksInfo": {
        "type": "object",
        "properties": {
          "total": {
            "type": "integer",
            "description": "Total stock count",
            "example": 1800
          },
          "byMarket": {
            "type": "object",
            "additionalProperties": {
              "type": "integer"
            },
            "description": "Stock count by market",
            "example": {
              "prime": 1500,
              "standard": 300
            }
          }
        },
        "required": [
          "total",
          "byMarket"
        ]
      },
      "StockDataInfo": {
        "type": "object",
        "properties": {
          "count": {
            "type": "integer",
            "description": "Number of unique dates",
            "example": 252
          },
          "dateRange": {
            "type": "object",
            "nullable": true,
            "properties": {
              "min": {
                "type": "string",
                "description": "Earliest date",
                "example": "2024-01-01"
              },
              "max": {
                "type": "string",
                "description": "Latest date",
                "example": "2025-01-15"
              }
            },
            "required": [
              "min",
              "max"
            ]
          },
          "missingDates": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "List of missing dates (max 20)",
            "example": [
              "2025-01-14"
            ]
          },
          "missingDatesCount": {
            "type": "integer",
            "description": "Total missing dates count",
            "example": 1
          }
        },
        "required": [
          "count",
          "dateRange",
          "missingDates",
          "missingDatesCount"
        ]
      },
      "AdjustmentEvent": {
        "type": "object",
        "properties": {
          "code": {
            "type": "string",
            "description": "Stock code",
            "example": "7203"
          },
          "date": {
            "type": "string",
            "description": "Event date",
            "example": "2025-01-15"
          },
          "adjustmentFactor": {
            "type": "number",
            "description": "Adjustment factor",
            "example": 0.5
          },
          "close": {
            "type": "number",
            "description": "Closing price",
            "example": 2500
          },
          "eventType": {
            "type": "string",
            "description": "Event interpretation",
            "example": "1:2 stock split"
          }
        },
        "required": [
          "code",
          "date",
          "adjustmentFactor",
          "close",
          "eventType"
        ]
      },
      "IntegrityIssue": {
        "type": "object",
        "properties": {
          "code": {
            "type": "string",
            "description": "Stock code",
            "example": "7203"
          },
          "count": {
            "type": "integer",
            "description": "Number of records outside range",
            "example": 5
          }
        },
        "required": [
          "code",
          "count"
        ]
      },
      "MarketValidationResponse": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string",
            "enum": [
              "healthy",
              "warning",
              "error"
            ],
            "description": "Overall health status",
            "example": "healthy"
          },
          "initialized": {
            "type": "boolean",
            "description": "Database initialized",
            "example": true
          },
          "lastSync": {
            "type": "string",
            "nullable": true,
            "description": "Last sync timestamp",
            "example": "2025-01-15T10:00:00.000Z"
          },
          "lastStocksRefresh": {
            "type": "string",
            "nullable": true,
            "description": "Last stocks refresh timestamp",
            "example": "2025-01-15T10:00:00.000Z"
          },
          "topix": {
            "$ref": "#/components/schemas/TopixInfo"
          },
          "stocks": {
            "$ref": "#/components/schemas/StocksInfo"
          },
          "stockData": {
            "$ref": "#/components/schemas/StockDataInfo"
          },
          "failedDates": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Dates pending retry (max 10)",
            "example": []
          },
          "failedDatesCount": {
            "type": "integer",
            "description": "Total failed dates count",
            "example": 0
          },
          "adjustmentEvents": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AdjustmentEvent"
            },
            "description": "Stock split/merger events (max 20)"
          },
          "adjustmentEventsCount": {
            "type": "integer",
            "description": "Total adjustment events count",
            "example": 0
          },
          "stocksNeedingRefresh": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Stock codes needing refresh (max 20)",
            "example": []
          },
          "stocksNeedingRefreshCount": {
            "type": "integer",
            "description": "Total stocks needing refresh",
            "example": 0
          },
          "integrityIssues": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/IntegrityIssue"
            },
            "description": "Stocks with data outside TOPIX range (max 10)"
          },
          "integrityIssuesCount": {
            "type": "integer",
            "description": "Total integrity issues count",
            "example": 0
          },
          "recommendations": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Action recommendations"
          },
          "lastUpdated": {
            "type": "string",
            "format": "date-time",
            "description": "Response timestamp"
          }
        },
        "required": [
          "status",
          "initialized",
          "lastSync",
          "lastStocksRefresh",
          "topix",
          "stocks",
          "stockData",
          "failedDates",
          "failedDatesCount",
          "adjustmentEvents",
          "adjustmentEventsCount",
          "stocksNeedingRefresh",
          "stocksNeedingRefreshCount",
          "integrityIssues",
          "integrityIssuesCount",
          "recommendations",
          "lastUpdated"
        ],
        "description": "Market database validation report"
      },
      "DatasetListItem": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Dataset filename",
            "example": "prime.db"
          },
          "fileSize": {
            "type": "integer",
            "description": "File size in bytes",
            "example": 104857600
          },
          "lastModified": {
            "type": "string",
            "format": "date-time",
            "description": "Last modification time"
          },
          "preset": {
            "type": "string",
            "nullable": true,
            "description": "Preset used to create this dataset",
            "example": "primeMarket"
          },
          "createdAt": {
            "type": "string",
            "nullable": true,
            "format": "date-time",
            "description": "Dataset creation time"
          }
        },
        "required": [
          "name",
          "fileSize",
          "lastModified",
          "preset",
          "createdAt"
        ]
      },
      "DatasetListResponse": {
        "type": "object",
        "properties": {
          "datasets": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DatasetListItem"
            },
            "description": "List of datasets"
          },
          "totalCount": {
            "type": "integer",
            "description": "Total number of datasets",
            "example": 3
          }
        },
        "required": [
          "datasets",
          "totalCount"
        ]
      },
      "DatasetDeleteResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Whether deletion was successful"
          },
          "name": {
            "type": "string",
            "description": "Deleted dataset name"
          },
          "message": {
            "type": "string",
            "description": "Result message"
          }
        },
        "required": [
          "success",
          "name",
          "message"
        ]
      },
      "CreateDatasetJobResponse": {
        "type": "object",
        "properties": {
          "jobId": {
            "type": "string",
            "format": "uuid",
            "description": "Unique job identifier"
          },
          "status": {
            "type": "string",
            "enum": [
              "pending",
              "running",
              "completed",
              "failed",
              "cancelled"
            ],
            "description": "Current job status",
            "example": "running"
          },
          "name": {
            "type": "string",
            "description": "Dataset name"
          },
          "preset": {
            "type": "string",
            "enum": [
              "fullMarket",
              "primeMarket",
              "standardMarket",
              "growthMarket",
              "quickTesting",
              "topix100",
              "topix500",
              "mid400",
              "primeExTopix500"
            ],
            "description": "Dataset preset configuration",
            "example": "primeMarket"
          },
          "message": {
            "type": "string",
            "description": "Status message",
            "example": "Dataset creation job started"
          },
          "estimatedTime": {
            "type": "string",
            "description": "Estimated completion time",
            "example": "10-30 minutes"
          }
        },
        "required": [
          "jobId",
          "status",
          "name",
          "preset",
          "message"
        ]
      },
      "DatasetCreateRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "minLength": 1,
            "maxLength": 255,
            "description": "Dataset filename (will be created in XDG datasets directory)",
            "example": "prime.db"
          },
          "preset": {
            "type": "string",
            "enum": [
              "fullMarket",
              "primeMarket",
              "standardMarket",
              "growthMarket",
              "quickTesting",
              "topix100",
              "topix500",
              "mid400",
              "primeExTopix500"
            ],
            "description": "Preset configuration to use",
            "example": "primeMarket"
          },
          "overwrite": {
            "type": "boolean",
            "default": false,
            "description": "Overwrite existing dataset",
            "example": false
          },
          "timeoutMinutes": {
            "type": "integer",
            "minimum": 1,
            "maximum": 120,
            "description": "Job timeout in minutes (default: 35)",
            "example": 30
          }
        },
        "required": [
          "name",
          "preset"
        ]
      },
      "DatasetJobProgress": {
        "type": "object",
        "properties": {
          "stage": {
            "type": "string",
            "description": "Current stage name",
            "example": "Fetching stock data"
          },
          "current": {
            "type": "integer",
            "description": "Current progress count",
            "example": 50
          },
          "total": {
            "type": "integer",
            "description": "Total items to process",
            "example": 1000
          },
          "percentage": {
            "type": "number",
            "description": "Progress percentage",
            "example": 5
          },
          "message": {
            "type": "string",
            "description": "Progress message",
            "example": "Processing 7203 (Toyota)"
          }
        },
        "required": [
          "stage",
          "current",
          "total",
          "percentage",
          "message"
        ]
      },
      "DatasetJobResult": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Whether creation was successful",
            "example": true
          },
          "totalStocks": {
            "type": "integer",
            "description": "Total stocks in dataset",
            "example": 1000
          },
          "processedStocks": {
            "type": "integer",
            "description": "Number of stocks processed",
            "example": 1000
          },
          "warnings": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Warning messages",
            "example": []
          },
          "errors": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Error messages",
            "example": []
          },
          "outputPath": {
            "type": "string",
            "description": "Path to created dataset",
            "example": "/home/user/.local/share/trading25/datasets/prime.db"
          }
        },
        "required": [
          "success",
          "totalStocks",
          "processedStocks",
          "warnings",
          "errors",
          "outputPath"
        ]
      },
      "DatasetJobResponse": {
        "type": "object",
        "properties": {
          "jobId": {
            "type": "string",
            "format": "uuid",
            "description": "Unique job identifier",
            "example": "123e4567-e89b-12d3-a456-426614174000"
          },
          "status": {
            "type": "string",
            "enum": [
              "pending",
              "running",
              "completed",
              "failed",
              "cancelled"
            ],
            "description": "Current job status",
            "example": "running"
          },
          "preset": {
            "type": "string",
            "enum": [
              "fullMarket",
              "primeMarket",
              "standardMarket",
              "growthMarket",
              "quickTesting",
              "topix100",
              "topix500",
              "mid400",
              "primeExTopix500"
            ],
            "description": "Dataset preset configuration",
            "example": "primeMarket"
          },
          "name": {
            "type": "string",
            "description": "Dataset name",
            "example": "prime.db"
          },
          "progress": {
            "$ref": "#/components/schemas/DatasetJobProgress"
          },
          "result": {
            "$ref": "#/components/schemas/DatasetJobResult"
          },
          "startedAt": {
            "type": "string",
            "format": "date-time",
            "description": "Job start time"
          },
          "completedAt": {
            "type": "string",
            "format": "date-time",
            "description": "Job completion time"
          },
          "error": {
            "type": "string",
            "description": "Error message if failed"
          }
        },
        "required": [
          "jobId",
          "status",
          "preset",
          "name",
          "startedAt"
        ],
        "description": "Dataset creation job status and progress"
      },
      "CancelDatasetJobResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Whether cancellation was successful"
          },
          "jobId": {
            "type": "string",
            "format": "uuid",
            "description": "Job ID"
          },
          "message": {
            "type": "string",
            "description": "Result message"
          }
        },
        "required": [
          "success",
          "jobId",
          "message"
        ]
      },
      "StatementsFieldCoverage": {
        "type": "object",
        "nullable": true,
        "properties": {
          "total": {
            "type": "integer",
            "description": "Total statements records",
            "example": 5000
          },
          "totalFY": {
            "type": "integer",
            "description": "FY (full year) records only",
            "example": 1000
          },
          "totalHalf": {
            "type": "integer",
            "description": "FY + 2Q (half year) records",
            "example": 2000
          },
          "hasExtendedFields": {
            "type": "boolean",
            "description": "Whether extended fields exist in schema",
            "example": true
          },
          "hasCashFlowFields": {
            "type": "boolean",
            "description": "Whether cash flow extended fields exist in schema",
            "example": true
          },
          "earningsPerShare": {
            "type": "integer",
            "description": "Records with EPS data",
            "example": 4900
          },
          "profit": {
            "type": "integer",
            "description": "Records with profit data",
            "example": 4800
          },
          "equity": {
            "type": "integer",
            "description": "Records with equity data",
            "example": 4700
          },
          "nextYearForecastEps": {
            "type": "integer",
            "description": "Records with next year forecast EPS (FY only)",
            "example": 900
          },
          "bps": {
            "type": "integer",
            "description": "Records with BPS data (FY only)",
            "example": 950
          },
          "sales": {
            "type": "integer",
            "description": "Records with sales data",
            "example": 4800
          },
          "operatingProfit": {
            "type": "integer",
            "description": "Records with operating profit",
            "example": 4700
          },
          "ordinaryProfit": {
            "type": "integer",
            "description": "Records with ordinary profit (J-GAAP only)",
            "example": 2000
          },
          "operatingCashFlow": {
            "type": "integer",
            "description": "Records with operating cash flow (FY/2Q only)",
            "example": 1800
          },
          "dividendFY": {
            "type": "integer",
            "description": "Records with dividend data (FY only)",
            "example": 900
          },
          "forecastEps": {
            "type": "integer",
            "description": "Records with forecast EPS",
            "example": 4000
          },
          "investingCashFlow": {
            "type": "integer",
            "description": "Records with investing cash flow (primarily FY/2Q)",
            "example": 1800
          },
          "financingCashFlow": {
            "type": "integer",
            "description": "Records with financing cash flow (primarily FY/2Q)",
            "example": 1800
          },
          "cashAndEquivalents": {
            "type": "integer",
            "description": "Records with cash and equivalents (primarily FY/2Q)",
            "example": 1800
          },
          "totalAssets": {
            "type": "integer",
            "description": "Records with total assets (all periods)",
            "example": 4000
          },
          "sharesOutstanding": {
            "type": "integer",
            "description": "Records with shares outstanding (all periods)",
            "example": 4000
          },
          "treasuryShares": {
            "type": "integer",
            "description": "Records with treasury shares (all periods)",
            "example": 3900
          }
        },
        "required": [
          "total",
          "totalFY",
          "totalHalf",
          "hasExtendedFields",
          "hasCashFlowFields",
          "earningsPerShare",
          "profit",
          "equity",
          "nextYearForecastEps",
          "bps",
          "sales",
          "operatingProfit",
          "ordinaryProfit",
          "operatingCashFlow",
          "dividendFY",
          "forecastEps",
          "investingCashFlow",
          "financingCashFlow",
          "cashAndEquivalents",
          "totalAssets",
          "sharesOutstanding",
          "treasuryShares"
        ],
        "description": "Field coverage for extended financial metrics (null if no statements data)"
      },
      "DatasetInfoResponse": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Dataset name",
            "example": "prime.db"
          },
          "path": {
            "type": "string",
            "description": "Full path to dataset"
          },
          "fileSize": {
            "type": "integer",
            "description": "File size in bytes",
            "example": 104857600
          },
          "lastModified": {
            "type": "string",
            "format": "date-time",
            "description": "Last modification time"
          },
          "snapshot": {
            "type": "object",
            "properties": {
              "preset": {
                "type": "string",
                "nullable": true,
                "description": "Preset used to create this dataset",
                "example": "primeMarket"
              },
              "createdAt": {
                "type": "string",
                "nullable": true,
                "format": "date-time",
                "description": "Dataset creation time"
              }
            },
            "required": [
              "preset",
              "createdAt"
            ],
            "description": "Snapshot metadata (preset configuration and creation time)"
          },
          "stats": {
            "type": "object",
            "properties": {
              "totalStocks": {
                "type": "integer",
                "description": "Total stocks",
                "example": 1000
              },
              "totalQuotes": {
                "type": "integer",
                "description": "Total quote records",
                "example": 250000
              },
              "dateRange": {
                "type": "object",
                "properties": {
                  "from": {
                    "type": "string",
                    "description": "Earliest date",
                    "example": "2015-01-01"
                  },
                  "to": {
                    "type": "string",
                    "description": "Latest date",
                    "example": "2025-01-01"
                  }
                },
                "required": [
                  "from",
                  "to"
                ]
              },
              "hasMarginData": {
                "type": "boolean",
                "description": "Contains margin data"
              },
              "hasTOPIXData": {
                "type": "boolean",
                "description": "Contains TOPIX data"
              },
              "hasSectorData": {
                "type": "boolean",
                "description": "Contains sector index data"
              },
              "hasStatementsData": {
                "type": "boolean",
                "description": "Contains financial statements"
              },
              "statementsFieldCoverage": {
                "$ref": "#/components/schemas/StatementsFieldCoverage"
              }
            },
            "required": [
              "totalStocks",
              "totalQuotes",
              "dateRange",
              "hasMarginData",
              "hasTOPIXData",
              "hasSectorData",
              "hasStatementsData",
              "statementsFieldCoverage"
            ]
          },
          "validation": {
            "type": "object",
            "properties": {
              "isValid": {
                "type": "boolean",
                "description": "Whether dataset is valid"
              },
              "errors": {
                "type": "array",
                "items": {
                  "type": "string"
                },
                "description": "Validation errors",
                "example": []
              },
              "warnings": {
                "type": "array",
                "items": {
                  "type": "string"
                },
                "description": "Validation warnings",
                "example": []
              },
              "details": {
                "type": "object",
                "properties": {
                  "dateGapsCount": {
                    "type": "integer",
                    "description": "Number of missing trading days"
                  },
                  "fkIntegrity": {
                    "type": "object",
                    "properties": {
                      "stockDataOrphans": {
                        "type": "integer"
                      },
                      "marginDataOrphans": {
                        "type": "integer"
                      },
                      "statementsOrphans": {
                        "type": "integer"
                      }
                    },
                    "required": [
                      "stockDataOrphans",
                      "marginDataOrphans",
                      "statementsOrphans"
                    ],
                    "description": "Foreign key integrity issues"
                  },
                  "orphanStocksCount": {
                    "type": "integer",
                    "description": "Stocks without quote data"
                  },
                  "stockCountValidation": {
                    "type": "object",
                    "properties": {
                      "preset": {
                        "type": "string",
                        "nullable": true
                      },
                      "expected": {
                        "type": "object",
                        "nullable": true,
                        "properties": {
                          "min": {
                            "type": "integer"
                          },
                          "max": {
                            "type": "integer"
                          }
                        },
                        "required": [
                          "min",
                          "max"
                        ]
                      },
                      "actual": {
                        "type": "integer"
                      },
                      "isWithinRange": {
                        "type": "boolean"
                      }
                    },
                    "required": [
                      "preset",
                      "expected",
                      "actual",
                      "isWithinRange"
                    ],
                    "description": "Stock count validation result"
                  },
                  "dataCoverage": {
                    "type": "object",
                    "properties": {
                      "totalStocks": {
                        "type": "integer",
                        "description": "Total stocks in dataset"
                      },
                      "stocksWithQuotes": {
                        "type": "integer",
                        "description": "Stocks with quote data"
                      },
                      "stocksWithStatements": {
                        "type": "integer",
                        "description": "Stocks with statements data"
                      },
                      "stocksWithMargin": {
                        "type": "integer",
                        "description": "Stocks with margin data"
                      }
                    },
                    "required": [
                      "totalStocks",
                      "stocksWithQuotes",
                      "stocksWithStatements",
                      "stocksWithMargin"
                    ],
                    "description": "Data coverage details"
                  }
                },
                "description": "Validation details"
              }
            },
            "required": [
              "isValid",
              "errors",
              "warnings"
            ],
            "description": "Validation results"
          }
        },
        "required": [
          "name",
          "path",
          "fileSize",
          "lastModified",
          "snapshot",
          "stats",
          "validation"
        ]
      },
      "DatasetSampleResponse": {
        "type": "object",
        "properties": {
          "codes": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Sampled stock codes",
            "example": [
              "7203",
              "9984",
              "6758"
            ]
          },
          "metadata": {
            "type": "object",
            "properties": {
              "totalAvailable": {
                "type": "integer",
                "description": "Total available stocks"
              },
              "sampleSize": {
                "type": "integer",
                "description": "Actual sample size"
              },
              "stratificationUsed": {
                "type": "boolean",
                "description": "Whether stratification was used"
              },
              "marketDistribution": {
                "type": "object",
                "additionalProperties": {
                  "type": "integer"
                }
              },
              "sectorDistribution": {
                "type": "object",
                "additionalProperties": {
                  "type": "integer"
                }
              }
            },
            "required": [
              "totalAvailable",
              "sampleSize",
              "stratificationUsed"
            ]
          }
        },
        "required": [
          "codes",
          "metadata"
        ]
      },
      "DatasetSearchResponse": {
        "type": "object",
        "properties": {
          "results": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "code": {
                  "type": "string",
                  "description": "Stock code",
                  "example": "7203"
                },
                "companyName": {
                  "type": "string",
                  "description": "Company name",
                  "example": "„Éà„É®„ÇøËá™ÂãïËªä"
                },
                "companyNameEnglish": {
                  "type": "string",
                  "description": "Company name in English",
                  "example": "Toyota Motor Corporation"
                },
                "marketName": {
                  "type": "string",
                  "description": "Market name",
                  "example": "„Éó„É©„Ç§„É†"
                },
                "sectorName": {
                  "type": "string",
                  "description": "Sector name",
                  "example": "Ëº∏ÈÄÅÁî®Ê©üÂô®"
                },
                "matchType": {
                  "type": "string",
                  "enum": [
                    "code",
                    "name",
                    "english_name"
                  ],
                  "description": "How the result matched"
                }
              },
              "required": [
                "code",
                "companyName",
                "marketName",
                "sectorName",
                "matchType"
              ]
            },
            "description": "Search results"
          },
          "totalFound": {
            "type": "integer",
            "description": "Total matches found",
            "example": 5
          }
        },
        "required": [
          "results",
          "totalFound"
        ]
      }
    },
    "parameters": {}
  },
  "paths": {
    "/health": {
      "get": {
        "tags": [
          "Health"
        ],
        "summary": "Health check",
        "description": "Check if the API service is running and responsive",
        "responses": {
          "200": {
            "description": "Service is healthy",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/jquants/auth/status": {
      "get": {
        "tags": [
          "JQuants Proxy"
        ],
        "summary": "Get JQuants API v2 authentication status",
        "description": "Check if JQUANTS_API_KEY is configured for API v2 authentication",
        "responses": {
          "200": {
            "description": "Authentication status retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthStatusResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/jquants/daily-quotes": {
      "get": {
        "tags": [
          "JQuants Proxy"
        ],
        "summary": "üîß Get daily stock quotes (raw JQuants format)",
        "description": "**Layer 1: JQuants Proxy API** - Raw data for debugging and development\n\n**Purpose**: Returns unprocessed JQuants API data with all original fields preserved.\n\n**Use Cases**:\n- Debugging JQuants API responses\n- Data integrity verification\n- Custom data processing development\n- Comparing raw vs processed data\n\n‚ö†Ô∏è **For production applications**, use `/api/chart/stocks/{symbol}` instead (optimized, cached, chart-ready format).\n\n**Characteristics**:\n- Raw JQuants field names (e.g., \"Date\", \"Code\", \"Open\", \"High\", \"Low\", \"Close\")\n- No caching applied\n- Minimal processing overhead\n- Complete data structure from JQuants",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "example": "7203",
              "description": "Stock code"
            },
            "required": true,
            "description": "Stock code",
            "name": "code",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "example": "2024-01-01",
              "description": "Start date (YYYY-MM-DD)"
            },
            "required": false,
            "description": "Start date (YYYY-MM-DD)",
            "name": "from",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "example": "2024-12-31",
              "description": "End date (YYYY-MM-DD)"
            },
            "required": false,
            "description": "End date (YYYY-MM-DD)",
            "name": "to",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "example": "2024-12-01",
              "description": "Specific date (YYYY-MM-DD)"
            },
            "required": false,
            "description": "Specific date (YYYY-MM-DD)",
            "name": "date",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Daily quotes retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DailyQuotesResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/jquants/indices": {
      "get": {
        "tags": [
          "JQuants Proxy"
        ],
        "summary": "Get index data",
        "description": "Fetch historical index data with optional filtering by code or date range",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "example": "0000",
              "description": "Index code (e.g., 0000 for Nikkei 225)"
            },
            "required": false,
            "description": "Index code (e.g., 0000 for Nikkei 225)",
            "name": "code",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
              "description": "Date in YYYY-MM-DD format",
              "example": "2024-01-01"
            },
            "required": false,
            "description": "Date in YYYY-MM-DD format",
            "name": "from",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
              "description": "Date in YYYY-MM-DD format",
              "example": "2024-01-01"
            },
            "required": false,
            "description": "Date in YYYY-MM-DD format",
            "name": "to",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
              "description": "Date in YYYY-MM-DD format",
              "example": "2024-01-01"
            },
            "required": false,
            "description": "Date in YYYY-MM-DD format",
            "name": "date",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Indices data retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiIndicesResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Unprocessable request (e.g., invalid date range)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/jquants/listed-info": {
      "get": {
        "tags": [
          "JQuants Proxy"
        ],
        "summary": "Get listed stock information",
        "description": "Fetch listed stock information with optional filtering by code or date",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 4,
              "maxLength": 4,
              "pattern": "^[0-9A-Z]+$",
              "example": "7203",
              "description": "Stock code (4 characters, e.g., 7203 for Toyota)"
            },
            "required": false,
            "description": "Stock code (4 characters, e.g., 7203 for Toyota)",
            "name": "code",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
              "description": "Date in YYYY-MM-DD format",
              "example": "2024-01-01"
            },
            "required": false,
            "description": "Date in YYYY-MM-DD format",
            "name": "date",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Listed info retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiListedInfoResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/jquants/stocks/{symbol}/margin-interest": {
      "get": {
        "tags": [
          "JQuants Proxy"
        ],
        "summary": "Get weekly margin interest data",
        "description": "Fetch weekly margin interest data for a specific stock with optional date range filtering",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 4,
              "maxLength": 4,
              "pattern": "^[0-9A-Z]+$",
              "example": "7203",
              "description": "Stock symbol (4 characters, e.g., 7203 for Toyota)"
            },
            "required": true,
            "description": "Stock symbol (4 characters, e.g., 7203 for Toyota)",
            "name": "symbol",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
              "description": "Date in YYYY-MM-DD format",
              "example": "2024-01-01"
            },
            "required": false,
            "description": "Date in YYYY-MM-DD format",
            "name": "from",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
              "description": "Date in YYYY-MM-DD format",
              "example": "2024-01-01"
            },
            "required": false,
            "description": "Date in YYYY-MM-DD format",
            "name": "to",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
              "description": "Date in YYYY-MM-DD format",
              "example": "2024-01-01"
            },
            "required": false,
            "description": "Date in YYYY-MM-DD format",
            "name": "date",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Margin interest data retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiMarginInterestResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Unprocessable request (e.g., invalid date range)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/jquants/statements": {
      "get": {
        "tags": [
          "JQuants Proxy"
        ],
        "summary": "üîß Get financial statements (raw JQuants format)",
        "description": "**Layer 1: JQuants Proxy API** - Raw financial statements for debugging\n\n**Purpose**: Returns EPS-related fields from JQuants statements API for verifying forecast EPS logic.\n\n**Key Fields**:\n- `EPS`: Actual earnings per share\n- `FEPS`: Current FY forecast EPS (for FY statements = completed year, for Q statements = in-progress year)\n- `NxFEPS`: Next FY forecast EPS\n\n‚ö†Ô∏è **For production applications**, use `/api/analytics/fundamentals/{symbol}` instead.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "example": "6857",
              "description": "Stock code (4-5 digits)"
            },
            "required": true,
            "description": "Stock code (4-5 digits)",
            "name": "code",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Financial statements retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StatementsResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/jquants/topix": {
      "get": {
        "tags": [
          "JQuants Proxy"
        ],
        "summary": "Get TOPIX index data (raw)",
        "description": "Fetch raw TOPIX index data from JQuants API without caching",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "example": "2024-01-01",
              "description": "Start date (YYYY-MM-DD)"
            },
            "required": false,
            "description": "Start date (YYYY-MM-DD)",
            "name": "from",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "example": "2024-12-31",
              "description": "End date (YYYY-MM-DD)"
            },
            "required": false,
            "description": "End date (YYYY-MM-DD)",
            "name": "to",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "example": "2024-12-01",
              "description": "Specific date (YYYY-MM-DD)"
            },
            "required": false,
            "description": "Specific date (YYYY-MM-DD)",
            "name": "date",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "TOPIX data retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TopixRawResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/chart/indices": {
      "get": {
        "tags": [
          "Chart"
        ],
        "summary": "Get list of available indices",
        "description": "Fetch list of all available indices from index master table",
        "responses": {
          "200": {
            "description": "Indices list retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "indices": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "code": {
                            "type": "string",
                            "example": "0000",
                            "description": "Index code"
                          },
                          "name": {
                            "type": "string",
                            "example": "TOPIX",
                            "description": "Index name"
                          },
                          "nameEnglish": {
                            "type": "string",
                            "nullable": true,
                            "example": "TOPIX",
                            "description": "English name"
                          },
                          "category": {
                            "type": "string",
                            "example": "topix",
                            "description": "Index category"
                          },
                          "dataStartDate": {
                            "type": "string",
                            "nullable": true,
                            "example": "2008-05-07",
                            "description": "Data start date"
                          }
                        },
                        "required": [
                          "code",
                          "name",
                          "nameEnglish",
                          "category",
                          "dataStartDate"
                        ]
                      },
                      "description": "List of available indices"
                    },
                    "lastUpdated": {
                      "type": "string",
                      "example": "2024-01-01T00:00:00.000Z",
                      "description": "Last update time"
                    }
                  },
                  "required": [
                    "indices",
                    "lastUpdated"
                  ]
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/chart/indices/{code}": {
      "get": {
        "tags": [
          "Chart"
        ],
        "summary": "Get index OHLC data",
        "description": "Fetch historical OHLC data for a specific index",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "example": "0000",
              "description": "Index code"
            },
            "required": true,
            "description": "Index code",
            "name": "code",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Index data retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "string",
                      "example": "0000",
                      "description": "Index code"
                    },
                    "name": {
                      "type": "string",
                      "example": "TOPIX",
                      "description": "Index name"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "date": {
                            "type": "string",
                            "example": "2024-01-01",
                            "description": "Trading date"
                          },
                          "open": {
                            "type": "number",
                            "example": 2500.5,
                            "description": "Opening price"
                          },
                          "high": {
                            "type": "number",
                            "example": 2520,
                            "description": "High price"
                          },
                          "low": {
                            "type": "number",
                            "example": 2480,
                            "description": "Low price"
                          },
                          "close": {
                            "type": "number",
                            "example": 2510,
                            "description": "Closing price"
                          }
                        },
                        "required": [
                          "date",
                          "open",
                          "high",
                          "low",
                          "close"
                        ]
                      },
                      "description": "OHLC data points"
                    },
                    "lastUpdated": {
                      "type": "string",
                      "example": "2024-01-01T00:00:00.000Z",
                      "description": "Last update time"
                    }
                  },
                  "required": [
                    "code",
                    "name",
                    "data",
                    "lastUpdated"
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Index not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/chart/stocks/search": {
      "get": {
        "tags": [
          "Chart"
        ],
        "summary": "üîç Search stocks by code or company name",
        "description": "**Fuzzy search for stocks** - Search by stock code or company name (Japanese/English)\n\n**Use Cases**:\n- Autocomplete stock symbol input\n- Find stocks by company name\n- Quick stock lookup\n\n**Search Priority**:\n1. Exact code match\n2. Code prefix match\n3. Company name (Japanese) match\n4. Company name (English) match\n\n**Example Queries**:\n- `7203` ‚Üí Toyota Motor Corporation\n- `„Éà„É®„Çø` ‚Üí Toyota Motor Corporation\n- `Toyota` ‚Üí Toyota Motor Corporation\n- `ÈäÄË°å` ‚Üí All banks\n\n**Response**:\n```json\n{\n  \"query\": \"„Éà„É®„Çø\",\n  \"results\": [\n    {\n      \"code\": \"7203\",\n      \"companyName\": \"„Éà„É®„ÇøËá™ÂãïËªä\",\n      \"companyNameEnglish\": \"TOYOTA MOTOR CORPORATION\",\n      \"marketCode\": \"prime\",\n      \"marketName\": \"„Éó„É©„Ç§„É†\",\n      \"sector33Name\": \"Ëº∏ÈÄÅÁî®Ê©üÂô®\"\n    }\n  ],\n  \"count\": 1\n}\n```",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "maxLength": 100,
              "example": "„Éà„É®„Çø",
              "description": "Search query (stock code or company name)"
            },
            "required": true,
            "description": "Search query (stock code or company name)",
            "name": "q",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "default": "20",
              "example": "20",
              "description": "Maximum number of results (1-100, default: 20)"
            },
            "required": false,
            "description": "Maximum number of results (1-100, default: 20)",
            "name": "limit",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Search results returned successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StockSearchResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid search parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/chart/stocks/{symbol}": {
      "get": {
        "tags": [
          "Chart"
        ],
        "summary": "üöÄ Get stock chart data (optimized for production)",
        "description": "**Layer 2: Chart & Analytics API** - Optimized data for production applications\n\n**Purpose**: Returns processed, chart-ready data optimized for visualization and performance.\n\n**Use Cases**:\n- Web UI chart rendering with lightweight-charts\n- CLI data display and reporting\n- Production application data consumption\n- Performance-critical operations\n\n‚úÖ **This is the recommended endpoint for production applications.**\n\n**Characteristics**:\n- Chart-ready format (camelCase: \"time\", \"open\", \"high\", \"low\", \"close\", \"volume\")\n- Optimized for lightweight-charts library\n- Caching enabled for performance\n- Consistent data structure\n- Company name included automatically\n\n**Data Format**:\n```json\n{\n  \"symbol\": \"7203\",\n  \"companyName\": \"„Éà„É®„ÇøËá™ÂãïËªä\",\n  \"timeframe\": \"daily\",\n  \"data\": [\n    {\n      \"time\": \"2024-12-01\",\n      \"open\": 2850.0,\n      \"high\": 2900.0,\n      \"low\": 2840.0,\n      \"close\": 2880.0,\n      \"volume\": 15230000\n    }\n  ],\n  \"lastUpdated\": \"2024-12-16T10:00:00Z\"\n}\n```\n\nüîß **For debugging raw JQuants data**, use `/api/jquants/daily-quotes` instead.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 4,
              "maxLength": 4,
              "pattern": "^[0-9A-Z]+$",
              "example": "7203",
              "description": "Stock symbol (4 characters, e.g., 7203 for Toyota)"
            },
            "required": true,
            "description": "Stock symbol (4 characters, e.g., 7203 for Toyota)",
            "name": "symbol",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "daily",
                "weekly",
                "monthly"
              ],
              "default": "daily",
              "description": "Data aggregation timeframe",
              "example": "daily"
            },
            "required": false,
            "description": "Data aggregation timeframe",
            "name": "timeframe",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "true",
                "false"
              ],
              "default": "true",
              "description": "Whether to return adjusted prices (default: true)",
              "example": "true"
            },
            "required": false,
            "description": "Whether to return adjusted prices (default: true)",
            "name": "adjusted",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Stock data retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiStockDataResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Stock symbol not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/chart/indices/topix": {
      "get": {
        "tags": [
          "Chart"
        ],
        "summary": "Get TOPIX index data (cached)",
        "description": "Fetch historical TOPIX index data optimized for chart display. Cached for 1 hour for performance.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
              "description": "Date in YYYY-MM-DD format",
              "example": "2024-01-01"
            },
            "required": false,
            "description": "Date in YYYY-MM-DD format",
            "name": "from",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
              "description": "Date in YYYY-MM-DD format",
              "example": "2024-01-01"
            },
            "required": false,
            "description": "Date in YYYY-MM-DD format",
            "name": "to",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
              "description": "Date in YYYY-MM-DD format",
              "example": "2024-01-01"
            },
            "required": false,
            "description": "Date in YYYY-MM-DD format",
            "name": "date",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "TOPIX data retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiTopixDataResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Unprocessable request (e.g., invalid date range)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/analytics/factor-regression/{symbol}": {
      "get": {
        "tags": [
          "Analytics"
        ],
        "summary": "Analyze stock risk factors via OLS regression",
        "description": "Perform two-stage factor regression analysis for risk decomposition:\n\n**Stage 1: Market Regression**\n`r_stock = Œ± + Œ≤m √ó r_TOPIX + residual`\n- Returns market beta (Œ≤m) and R¬≤ (market exposure)\n\n**Stage 2: Residual Factor Matching**\n`residual ~ r_index` for each index category\n- TOPIX-17 Sectors: Top 3 matching indices\n- 33 Sectors: Top 3 matching indices\n- TOPIX Size + Market + Style: Top 3 matching indices\n\nThis analysis helps identify which risk factors a stock is most exposed to beyond market risk.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 4,
              "maxLength": 4,
              "description": "Stock symbol (4-character code)",
              "example": "7203"
            },
            "required": true,
            "description": "Stock symbol (4-character code)",
            "name": "symbol",
            "in": "path"
          },
          {
            "schema": {
              "type": "integer",
              "minimum": 60,
              "maximum": 1000,
              "default": 252,
              "description": "Number of trading days for analysis (default: 252, min: 60, max: 1000)",
              "example": 252
            },
            "required": false,
            "description": "Number of trading days for analysis (default: 252, min: 60, max: 1000)",
            "name": "lookbackDays",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Factor regression analysis results",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FactorRegressionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Stock not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Insufficient data for analysis",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/analytics/fundamentals/{symbol}": {
      "get": {
        "tags": [
          "Analytics"
        ],
        "summary": "Get fundamental analysis metrics for a stock",
        "description": "Fetch financial statements from JQuants API and calculate fundamental metrics (ROE, PER, PBR, EPS, BPS, ROA, Operating Margin, Net Margin) for a specific stock. PER and PBR are calculated using stock prices at statement disclosure dates.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 4,
              "maxLength": 4,
              "description": "Stock symbol (4-character code)",
              "example": "7203"
            },
            "required": true,
            "description": "Stock symbol (4-character code)",
            "name": "symbol",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
              "description": "Start date filter (YYYY-MM-DD)",
              "example": "2020-01-01"
            },
            "required": false,
            "description": "Start date filter (YYYY-MM-DD)",
            "name": "from",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
              "description": "End date filter (YYYY-MM-DD)",
              "example": "2024-12-31"
            },
            "required": false,
            "description": "End date filter (YYYY-MM-DD)",
            "name": "to",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "all",
                "FY",
                "Q1",
                "Q2",
                "Q3"
              ],
              "default": "all",
              "description": "Filter by period type (default: all)",
              "example": "all"
            },
            "required": false,
            "description": "Filter by period type (default: all)",
            "name": "periodType",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "true",
                "false"
              ],
              "default": "true",
              "description": "Prefer consolidated over non-consolidated data (default: true)",
              "example": "true"
            },
            "required": false,
            "description": "Prefer consolidated over non-consolidated data (default: true)",
            "name": "preferConsolidated",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Fundamental analysis results with time series data",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FundamentalsResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Stock not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/analytics/stocks/{symbol}/margin-pressure": {
      "get": {
        "tags": [
          "Analytics"
        ],
        "summary": "Get margin pressure indicators",
        "description": "Fetch margin long pressure, flow pressure, and turnover days indicators for trading analysis",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 4,
              "maxLength": 4,
              "pattern": "^[0-9A-Z]+$",
              "example": "7203",
              "description": "Stock symbol (4 characters, e.g., 7203 for Toyota)"
            },
            "required": true,
            "description": "Stock symbol (4 characters, e.g., 7203 for Toyota)",
            "name": "symbol",
            "in": "path"
          },
          {
            "schema": {
              "type": "integer",
              "minimum": 5,
              "maximum": 60,
              "default": 15,
              "example": 15,
              "description": "Rolling average period in days (default: 15)"
            },
            "required": false,
            "description": "Rolling average period in days (default: 15)",
            "name": "period",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Margin pressure indicators retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiMarginPressureIndicatorsResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Stock symbol not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/analytics/stocks/{symbol}/margin-ratio": {
      "get": {
        "tags": [
          "Analytics"
        ],
        "summary": "Get margin volume ratio",
        "description": "Fetch calculated margin volume ratio data for trading analysis",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 4,
              "maxLength": 4,
              "pattern": "^[0-9A-Z]+$",
              "example": "7203",
              "description": "Stock symbol (4 characters, e.g., 7203 for Toyota)"
            },
            "required": true,
            "description": "Stock symbol (4 characters, e.g., 7203 for Toyota)",
            "name": "symbol",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Margin ratio data retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiMarginVolumeRatioResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Stock symbol not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/analytics/portfolio-factor-regression/{portfolioId}": {
      "get": {
        "tags": [
          "Analytics"
        ],
        "summary": "Analyze portfolio risk factors via OLS regression",
        "description": "Perform two-stage factor regression analysis on a portfolio for risk decomposition.\n\n**Weight Calculation**\nPortfolio weights are calculated using current market values:\n`weight_i = (quantity_i √ó latestPrice_i) / Œ£(quantity_j √ó latestPrice_j)`\n\n**Stage 1: Market Regression**\n`r_portfolio = Œ± + Œ≤m √ó r_TOPIX + residual`\n- Returns market beta (Œ≤m) and R¬≤ (market exposure)\n\n**Stage 2: Residual Factor Matching**\n`residual ~ r_index` for each index category\n- TOPIX-17 Sectors: Top 3 matching indices\n- 33 Sectors: Top 3 matching indices\n- TOPIX Size + Market + Style: Top 3 matching indices\n\nThis analysis helps identify which risk factors a portfolio is most exposed to beyond market risk.",
        "parameters": [
          {
            "schema": {
              "type": "integer",
              "minimum": 0,
              "exclusiveMinimum": true,
              "description": "Portfolio ID",
              "example": 1
            },
            "required": true,
            "description": "Portfolio ID",
            "name": "portfolioId",
            "in": "path"
          },
          {
            "schema": {
              "type": "integer",
              "minimum": 60,
              "maximum": 1000,
              "default": 252,
              "description": "Number of trading days for analysis (default: 252, min: 60, max: 1000)",
              "example": 252
            },
            "required": false,
            "description": "Number of trading days for analysis (default: 252, min: 60, max: 1000)",
            "name": "lookbackDays",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Portfolio factor regression analysis results",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PortfolioFactorRegressionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Portfolio not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Insufficient data for analysis",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/analytics/ranking": {
      "get": {
        "tags": [
          "Analytics"
        ],
        "summary": "Get market rankings",
        "description": "Get market rankings including top stocks by trading value, price gainers, and price losers. Supports single-day or multi-day average lookback.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
              "description": "Target date (YYYY-MM-DD). Defaults to latest trading date.",
              "example": "2025-01-15"
            },
            "required": false,
            "description": "Target date (YYYY-MM-DD). Defaults to latest trading date.",
            "name": "date",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "default": "20",
              "description": "Number of results per ranking (1-100, default: 20)",
              "example": "20"
            },
            "required": false,
            "description": "Number of results per ranking (1-100, default: 20)",
            "name": "limit",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "default": "prime",
              "description": "Market filter (prime, standard, or prime,standard)",
              "example": "prime"
            },
            "required": false,
            "description": "Market filter (prime, standard, or prime,standard)",
            "name": "markets",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "default": "1",
              "description": "Trading days to look back for average calculations (1-100, default: 1)",
              "example": "1"
            },
            "required": false,
            "description": "Trading days to look back for average calculations (1-100, default: 1)",
            "name": "lookbackDays",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "default": "250",
              "description": "Period days for high/low calculations (1-250, default: 250)",
              "example": "250"
            },
            "required": false,
            "description": "Period days for high/low calculations (1-250, default: 250)",
            "name": "periodDays",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Market rankings with trading value, gainers, and losers",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MarketRankingResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Database not initialized or no trading data available",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/analytics/roe": {
      "get": {
        "tags": [
          "Analytics"
        ],
        "summary": "Calculate Return on Equity (ROE)",
        "description": "Fetch financial statements from JQuants API and calculate ROE for specified stocks. Either code or date parameter is required.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "description": "Stock codes (comma-separated for multiple stocks, e.g., 7203,6758,9984)",
              "example": "7203"
            },
            "required": false,
            "description": "Stock codes (comma-separated for multiple stocks, e.g., 7203,6758,9984)",
            "name": "code",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d{4}-?\\d{2}-?\\d{2}$",
              "description": "Specific date to filter statements (YYYYMMDD or YYYY-MM-DD)",
              "example": "20241201"
            },
            "required": false,
            "description": "Specific date to filter statements (YYYYMMDD or YYYY-MM-DD)",
            "name": "date",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "true",
                "false"
              ],
              "default": "true",
              "description": "Annualize quarterly data (default: true)",
              "example": "true"
            },
            "required": false,
            "description": "Annualize quarterly data (default: true)",
            "name": "annualize",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "true",
                "false"
              ],
              "default": "true",
              "description": "Prefer consolidated over non-consolidated data (default: true)",
              "example": "true"
            },
            "required": false,
            "description": "Prefer consolidated over non-consolidated data (default: true)",
            "name": "preferConsolidated",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "default": "1000",
              "description": "Minimum equity threshold in millions of yen (default: 1000)",
              "example": "1000"
            },
            "required": false,
            "description": "Minimum equity threshold in millions of yen (default: 1000)",
            "name": "minEquity",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "roe",
                "code",
                "date"
              ],
              "default": "roe",
              "description": "Sort results by field (default: roe)",
              "example": "roe"
            },
            "required": false,
            "description": "Sort results by field (default: roe)",
            "name": "sortBy",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "default": "50",
              "description": "Maximum number of results to return (default: 50)",
              "example": "50"
            },
            "required": false,
            "description": "Maximum number of results to return (default: 50)",
            "name": "limit",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "ROE calculation results with summary statistics",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ROEResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters (either code or date is required)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/analytics/screening": {
      "get": {
        "tags": [
          "Analytics"
        ],
        "summary": "Run stock screening",
        "description": "Run stock screening analysis on market-wide data. Supports Range Break Fast and Range Break Slow strategies with volume validation.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "default": "prime",
              "description": "Market filter (prime, standard, or prime,standard)",
              "example": "prime"
            },
            "required": false,
            "description": "Market filter (prime, standard, or prime,standard)",
            "name": "markets",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "true",
                "false"
              ],
              "default": "true",
              "description": "Enable Range Break Fast screening (default: true)",
              "example": "true"
            },
            "required": false,
            "description": "Enable Range Break Fast screening (default: true)",
            "name": "rangeBreakFast",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "true",
                "false"
              ],
              "default": "true",
              "description": "Enable Range Break Slow screening (default: true)",
              "example": "true"
            },
            "required": false,
            "description": "Enable Range Break Slow screening (default: true)",
            "name": "rangeBreakSlow",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "default": "10",
              "description": "Days to look back for recent signals (1-90, default: 10)",
              "example": "10"
            },
            "required": false,
            "description": "Days to look back for recent signals (1-90, default: 10)",
            "name": "recentDays",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
              "description": "Reference date for historical screening (YYYY-MM-DD). When specified, screening runs as if this date is \"today\".",
              "example": "2025-01-18"
            },
            "required": false,
            "description": "Reference date for historical screening (YYYY-MM-DD). When specified, screening runs as if this date is \"today\".",
            "name": "date",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Minimum break percentage filter",
              "example": "5.0"
            },
            "required": false,
            "description": "Minimum break percentage filter",
            "name": "minBreakPercentage",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Minimum volume ratio filter",
              "example": "1.5"
            },
            "required": false,
            "description": "Minimum volume ratio filter",
            "name": "minVolumeRatio",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "date",
                "stockCode",
                "volumeRatio",
                "breakPercentage"
              ],
              "default": "date",
              "description": "Sort results by field (default: date)",
              "example": "date"
            },
            "required": false,
            "description": "Sort results by field (default: date)",
            "name": "sortBy",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "asc",
                "desc"
              ],
              "default": "desc",
              "description": "Sort order (default: desc)",
              "example": "desc"
            },
            "required": false,
            "description": "Sort order (default: desc)",
            "name": "order",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Limit number of results",
              "example": "50"
            },
            "required": false,
            "description": "Limit number of results",
            "name": "limit",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Screening results with summary statistics",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MarketScreeningResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Database not initialized or no data available",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/analytics/sector-stocks": {
      "get": {
        "tags": [
          "Analytics"
        ],
        "summary": "Get stocks by sector",
        "description": "Get stocks filtered by sector (sector33 or sector17) with trading data, sorted by trading value or price change percentage.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "description": "Sector 33 name to filter by (e.g., \"Ëº∏ÈÄÅÁî®Ê©üÂô®\")",
              "example": "Ëº∏ÈÄÅÁî®Ê©üÂô®"
            },
            "required": false,
            "description": "Sector 33 name to filter by (e.g., \"Ëº∏ÈÄÅÁî®Ê©üÂô®\")",
            "name": "sector33Name",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Sector 17 name to filter by (e.g., \"Ëá™ÂãïËªä„ÉªËº∏ÈÄÅÊ©ü\")",
              "example": "Ëá™ÂãïËªä„ÉªËº∏ÈÄÅÊ©ü"
            },
            "required": false,
            "description": "Sector 17 name to filter by (e.g., \"Ëá™ÂãïËªä„ÉªËº∏ÈÄÅÊ©ü\")",
            "name": "sector17Name",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "default": "prime,standard",
              "description": "Market filter (prime, standard, growth, or comma-separated)",
              "example": "prime,standard"
            },
            "required": false,
            "description": "Market filter (prime, standard, growth, or comma-separated)",
            "name": "markets",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "default": "5",
              "description": "Trading days to look back for price change calculations (1-100, default: 5)",
              "example": "5"
            },
            "required": false,
            "description": "Trading days to look back for price change calculations (1-100, default: 5)",
            "name": "lookbackDays",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "tradingValue",
                "changePercentage",
                "code"
              ],
              "default": "tradingValue",
              "description": "Sort field (tradingValue, changePercentage, code)",
              "example": "tradingValue"
            },
            "required": false,
            "description": "Sort field (tradingValue, changePercentage, code)",
            "name": "sortBy",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "asc",
                "desc"
              ],
              "default": "desc",
              "description": "Sort order (asc, desc)",
              "example": "desc"
            },
            "required": false,
            "description": "Sort order (asc, desc)",
            "name": "sortOrder",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "default": "100",
              "description": "Maximum number of results (1-500, default: 100)",
              "example": "100"
            },
            "required": false,
            "description": "Maximum number of results (1-500, default: 100)",
            "name": "limit",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Sector stocks with trading data",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SectorStocksResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Database not initialized or no trading data available",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/portfolio": {
      "get": {
        "tags": [
          "Portfolio"
        ],
        "summary": "List all portfolios",
        "description": "Retrieve all portfolios with summary statistics",
        "responses": {
          "200": {
            "description": "Portfolios retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListPortfoliosResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "Portfolio"
        ],
        "summary": "Create a new portfolio",
        "description": "Create a new portfolio with a unique name",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreatePortfolioRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Portfolio created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PortfolioResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "409": {
            "description": "Portfolio name already exists",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/portfolio/{id}": {
      "get": {
        "tags": [
          "Portfolio"
        ],
        "summary": "Get portfolio details",
        "description": "Retrieve a portfolio with all its items",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d+$",
              "example": "1",
              "description": "Portfolio ID"
            },
            "required": true,
            "description": "Portfolio ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Portfolio retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PortfolioWithItemsResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid portfolio ID",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Portfolio not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "Portfolio"
        ],
        "summary": "Update portfolio",
        "description": "Update portfolio name or description",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d+$",
              "example": "1",
              "description": "Portfolio ID"
            },
            "required": true,
            "description": "Portfolio ID",
            "name": "id",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdatePortfolioRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Portfolio updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PortfolioResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Portfolio not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "409": {
            "description": "Portfolio name already exists",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Portfolio"
        ],
        "summary": "Delete portfolio",
        "description": "Delete a portfolio and all its items",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d+$",
              "example": "1",
              "description": "Portfolio ID"
            },
            "required": true,
            "description": "Portfolio ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Portfolio deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DeleteSuccessResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid portfolio ID",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Portfolio not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/portfolio/{id}/items": {
      "post": {
        "tags": [
          "Portfolio"
        ],
        "summary": "Add stock to portfolio",
        "description": "Add a new stock holding to a portfolio",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d+$",
              "example": "1",
              "description": "Portfolio ID"
            },
            "required": true,
            "description": "Portfolio ID",
            "name": "id",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreatePortfolioItemRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Item added successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PortfolioItemResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Portfolio not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "409": {
            "description": "Stock already exists in portfolio",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/portfolio/{id}/items/{itemId}": {
      "put": {
        "tags": [
          "Portfolio"
        ],
        "summary": "Update portfolio item by ID",
        "description": "Update stock holding details using item ID (for programmatic access)",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d+$",
              "example": "1",
              "description": "Portfolio ID"
            },
            "required": true,
            "description": "Portfolio ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d+$",
              "example": "1",
              "description": "Portfolio Item ID"
            },
            "required": true,
            "description": "Portfolio Item ID",
            "name": "itemId",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdatePortfolioItemRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Item updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PortfolioItemResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Item not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Portfolio"
        ],
        "summary": "Delete portfolio item by ID",
        "description": "Remove a stock holding using item ID (for programmatic access)",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d+$",
              "example": "1",
              "description": "Portfolio ID"
            },
            "required": true,
            "description": "Portfolio ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d+$",
              "example": "1",
              "description": "Portfolio Item ID"
            },
            "required": true,
            "description": "Portfolio Item ID",
            "name": "itemId",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Item deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DeleteSuccessResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid item ID",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Item not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/portfolio/{portfolioName}/stocks/{code}": {
      "put": {
        "tags": [
          "Portfolio"
        ],
        "summary": "Update stock in portfolio",
        "description": "Update stock holding details in a portfolio",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "example": "My Portfolio",
              "description": "Portfolio name"
            },
            "required": true,
            "description": "Portfolio name",
            "name": "portfolioName",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d[0-9A-Z]\\d[0-9A-Z]$",
              "example": "7203",
              "description": "Stock code (4 characters)"
            },
            "required": true,
            "description": "Stock code (4 characters)",
            "name": "code",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdatePortfolioItemRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Stock updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PortfolioItemResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Portfolio or stock not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Portfolio"
        ],
        "summary": "Remove stock from portfolio",
        "description": "Remove a stock holding from a portfolio",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "example": "My Portfolio",
              "description": "Portfolio name"
            },
            "required": true,
            "description": "Portfolio name",
            "name": "portfolioName",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d[0-9A-Z]\\d[0-9A-Z]$",
              "example": "7203",
              "description": "Stock code (4 characters)"
            },
            "required": true,
            "description": "Stock code (4 characters)",
            "name": "code",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Item deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PortfolioItemDeletedResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Portfolio or stock not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/portfolio/{name}/codes": {
      "get": {
        "tags": [
          "Portfolio"
        ],
        "summary": "Get stock codes in portfolio",
        "description": "Get list of stock codes in a portfolio by portfolio name. Used by Python API clients.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "example": "My Portfolio",
              "description": "Portfolio name"
            },
            "required": true,
            "description": "Portfolio name",
            "name": "name",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Stock codes retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PortfolioCodesResponse"
                }
              }
            }
          },
          "404": {
            "description": "Portfolio not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/portfolio/{id}/performance": {
      "get": {
        "tags": [
          "Portfolio"
        ],
        "summary": "Get portfolio performance",
        "description": "Retrieve portfolio P&L metrics, holdings performance, and benchmark comparison",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d+$",
              "description": "Portfolio ID",
              "example": "1"
            },
            "required": true,
            "description": "Portfolio ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "minLength": 4,
              "maxLength": 4,
              "default": "0000",
              "description": "Benchmark index code (default: 0000 for TOPIX)",
              "example": "0000"
            },
            "required": false,
            "description": "Benchmark index code (default: 0000 for TOPIX)",
            "name": "benchmarkCode",
            "in": "query"
          },
          {
            "schema": {
              "type": "integer",
              "minimum": 30,
              "maximum": 1000,
              "default": 252,
              "description": "Number of trading days for time series analysis (default: 252)",
              "example": 252
            },
            "required": false,
            "description": "Number of trading days for time series analysis (default: 252)",
            "name": "lookbackDays",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Portfolio performance retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PortfolioPerformanceResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Portfolio not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/watchlist": {
      "get": {
        "tags": [
          "Watchlist"
        ],
        "summary": "List all watchlists",
        "description": "Retrieve all watchlists with summary statistics",
        "responses": {
          "200": {
            "description": "Watchlists retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListWatchlistsResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "Watchlist"
        ],
        "summary": "Create a new watchlist",
        "description": "Create a new watchlist with a unique name",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateWatchlistRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Watchlist created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WatchlistResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "409": {
            "description": "Watchlist name already exists",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/watchlist/{id}": {
      "get": {
        "tags": [
          "Watchlist"
        ],
        "summary": "Get watchlist details",
        "description": "Retrieve a watchlist with all its items",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d+$",
              "example": "1",
              "description": "Watchlist ID"
            },
            "required": true,
            "description": "Watchlist ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Watchlist retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WatchlistWithItemsResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid watchlist ID",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Watchlist not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "Watchlist"
        ],
        "summary": "Update watchlist",
        "description": "Update watchlist name or description",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d+$",
              "example": "1",
              "description": "Watchlist ID"
            },
            "required": true,
            "description": "Watchlist ID",
            "name": "id",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateWatchlistRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Watchlist updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WatchlistResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Watchlist not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "409": {
            "description": "Watchlist name already exists",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Watchlist"
        ],
        "summary": "Delete watchlist",
        "description": "Delete a watchlist and all its items",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d+$",
              "example": "1",
              "description": "Watchlist ID"
            },
            "required": true,
            "description": "Watchlist ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Watchlist deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WatchlistDeleteSuccessResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid watchlist ID",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Watchlist not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/watchlist/{id}/items": {
      "post": {
        "tags": [
          "Watchlist"
        ],
        "summary": "Add stock to watchlist",
        "description": "Add a stock to a watchlist (company name auto-fetched if not provided)",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d+$",
              "example": "1",
              "description": "Watchlist ID"
            },
            "required": true,
            "description": "Watchlist ID",
            "name": "id",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateWatchlistItemRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Stock added successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WatchlistItemResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Watchlist not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "409": {
            "description": "Stock already in watchlist",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/watchlist/{id}/items/{itemId}": {
      "delete": {
        "tags": [
          "Watchlist"
        ],
        "summary": "Remove stock from watchlist",
        "description": "Remove a stock from a watchlist by item ID",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d+$",
              "example": "1",
              "description": "Watchlist ID"
            },
            "required": true,
            "description": "Watchlist ID",
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d+$",
              "example": "1",
              "description": "Watchlist Item ID"
            },
            "required": true,
            "description": "Watchlist Item ID",
            "name": "itemId",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Stock removed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WatchlistDeleteSuccessResponse"
                }
              }
            }
          },
          "404": {
            "description": "Item not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/watchlist/{id}/prices": {
      "get": {
        "tags": [
          "Watchlist"
        ],
        "summary": "Get stock prices for watchlist",
        "description": "Retrieve latest stock prices for all stocks in a watchlist",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d+$",
              "example": "1",
              "description": "Watchlist ID"
            },
            "required": true,
            "description": "Watchlist ID",
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Prices retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WatchlistPricesResponse"
                }
              }
            }
          },
          "404": {
            "description": "Watchlist not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/db/stocks/refresh": {
      "post": {
        "tags": [
          "Database"
        ],
        "summary": "Refresh historical data for specific stocks",
        "description": "Refetch complete historical data for specified stocks to update adjusted prices after stock splits or mergers. Data is filtered to TOPIX date range for consistency.",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MarketRefreshRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Refresh completed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MarketRefreshResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Database not initialized or no TOPIX data available",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/db/stats": {
      "get": {
        "tags": [
          "Database"
        ],
        "summary": "Get market database statistics",
        "description": "Get statistics about the market database including TOPIX, stocks, stock data, and indices counts and date ranges.",
        "responses": {
          "200": {
            "description": "Market database statistics",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MarketStatsResponse"
                }
              }
            }
          },
          "422": {
            "description": "Database not found or cannot be opened",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/db/sync": {
      "post": {
        "tags": [
          "Database"
        ],
        "summary": "Start market data synchronization",
        "description": "Start a new market data sync job. Only one sync job can run at a time. Returns immediately with job ID for polling.",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MarketSyncRequest"
              }
            }
          }
        },
        "responses": {
          "202": {
            "description": "Sync job started",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateSyncJobResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "409": {
            "description": "Another sync job is already running",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/db/sync/jobs/{jobId}": {
      "get": {
        "tags": [
          "Database"
        ],
        "summary": "Get sync job status",
        "description": "Get the current status and progress of a sync job.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "format": "uuid",
              "description": "Job ID",
              "example": "123e4567-e89b-12d3-a456-426614174000"
            },
            "required": true,
            "description": "Job ID",
            "name": "jobId",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Job status retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SyncJobResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid job ID format",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Job not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Database"
        ],
        "summary": "Cancel sync job",
        "description": "Cancel a running or pending sync job.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "format": "uuid",
              "description": "Job ID",
              "example": "123e4567-e89b-12d3-a456-426614174000"
            },
            "required": true,
            "description": "Job ID",
            "name": "jobId",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Job cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CancelJobResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid job ID or job cannot be cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Job not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/db/validate": {
      "get": {
        "tags": [
          "Database"
        ],
        "summary": "Validate market database",
        "description": "Validate market database integrity, check for missing data, stock split/merger events, and provide recommendations for data maintenance.",
        "responses": {
          "200": {
            "description": "Market database validation report",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MarketValidationResponse"
                }
              }
            }
          },
          "422": {
            "description": "Database not found or cannot be opened",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/dataset": {
      "get": {
        "tags": [
          "Dataset"
        ],
        "summary": "List all datasets",
        "description": "Scan the datasets directory and return metadata for each .db file.",
        "responses": {
          "200": {
            "description": "Dataset list retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DatasetListResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "Dataset"
        ],
        "summary": "Start dataset creation",
        "description": "Start a new dataset creation job. Only one creation job can run at a time. Returns immediately with job ID for polling.",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DatasetCreateRequest"
              }
            }
          }
        },
        "responses": {
          "202": {
            "description": "Dataset creation job started",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateDatasetJobResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "409": {
            "description": "Another creation job is already running or dataset already exists",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/dataset/{name}": {
      "delete": {
        "tags": [
          "Dataset"
        ],
        "summary": "Delete a dataset",
        "description": "Delete a dataset file from the datasets directory.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "description": "Dataset name",
              "example": "prime.db"
            },
            "required": true,
            "description": "Dataset name",
            "name": "name",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Dataset deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DatasetDeleteResponse"
                }
              }
            }
          },
          "404": {
            "description": "Dataset not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/dataset/resume": {
      "post": {
        "tags": [
          "Dataset"
        ],
        "summary": "Resume incomplete dataset",
        "description": "Resume fetching missing data for an existing dataset. Detects and fetches only missing quotes/statements/margin data.",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DatasetCreateRequest"
              }
            }
          }
        },
        "responses": {
          "202": {
            "description": "Dataset resume job started",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateDatasetJobResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Dataset not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "409": {
            "description": "Another job is already running",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/dataset/jobs/{jobId}": {
      "get": {
        "tags": [
          "Dataset"
        ],
        "summary": "Get dataset creation job status",
        "description": "Get the current status and progress of a dataset creation job.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "format": "uuid",
              "description": "Job ID",
              "example": "123e4567-e89b-12d3-a456-426614174000"
            },
            "required": true,
            "description": "Job ID",
            "name": "jobId",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Job status retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DatasetJobResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid job ID format",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Job not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Dataset"
        ],
        "summary": "Cancel dataset creation job",
        "description": "Cancel a running or pending dataset creation job.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "format": "uuid",
              "description": "Job ID",
              "example": "123e4567-e89b-12d3-a456-426614174000"
            },
            "required": true,
            "description": "Job ID",
            "name": "jobId",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Job cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CancelDatasetJobResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid job ID or job cannot be cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Job not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/dataset/{name}/info": {
      "get": {
        "tags": [
          "Dataset"
        ],
        "summary": "Get dataset information",
        "description": "Get information about an existing dataset including statistics.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "description": "Dataset name",
              "example": "prime.db"
            },
            "required": true,
            "description": "Dataset name",
            "name": "name",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Dataset information",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DatasetInfoResponse"
                }
              }
            }
          },
          "404": {
            "description": "Dataset not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/dataset/{name}/sample": {
      "get": {
        "tags": [
          "Dataset"
        ],
        "summary": "Sample stocks from dataset",
        "description": "Get a random sample of stock codes from the dataset.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "description": "Dataset name",
              "example": "prime.db"
            },
            "required": true,
            "description": "Dataset name",
            "name": "name",
            "in": "path"
          },
          {
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 10000,
              "default": 300,
              "description": "Sample size",
              "example": 300
            },
            "required": false,
            "description": "Sample size",
            "name": "size",
            "in": "query"
          },
          {
            "schema": {
              "type": "boolean",
              "nullable": true,
              "description": "Stratify by market",
              "example": false
            },
            "required": false,
            "description": "Stratify by market",
            "name": "byMarket",
            "in": "query"
          },
          {
            "schema": {
              "type": "boolean",
              "nullable": true,
              "description": "Stratify by sector",
              "example": false
            },
            "required": false,
            "description": "Stratify by sector",
            "name": "bySector",
            "in": "query"
          },
          {
            "schema": {
              "type": "integer",
              "nullable": true,
              "description": "Random seed for reproducibility"
            },
            "required": false,
            "description": "Random seed for reproducibility",
            "name": "seed",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Sampled stock codes",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DatasetSampleResponse"
                }
              }
            }
          },
          "404": {
            "description": "Dataset not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/dataset/{name}/search": {
      "get": {
        "tags": [
          "Dataset"
        ],
        "summary": "Search stocks in dataset",
        "description": "Search for stocks by code or company name.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "description": "Dataset name",
              "example": "prime.db"
            },
            "required": true,
            "description": "Dataset name",
            "name": "name",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "description": "Search term (stock code or company name)",
              "example": "toyota"
            },
            "required": true,
            "description": "Search term (stock code or company name)",
            "name": "term",
            "in": "query"
          },
          {
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 100,
              "default": 20,
              "description": "Maximum results to return",
              "example": 20
            },
            "required": false,
            "description": "Maximum results to return",
            "name": "limit",
            "in": "query"
          },
          {
            "schema": {
              "type": "boolean",
              "nullable": true,
              "description": "Exact match only",
              "example": false
            },
            "required": false,
            "description": "Exact match only",
            "name": "exact",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Search results",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DatasetSearchResponse"
                }
              }
            }
          },
          "404": {
            "description": "Dataset not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/dataset/{name}/stocks/{code}/ohlcv": {
      "get": {
        "tags": [
          "Dataset Data"
        ],
        "summary": "Get stock OHLCV data",
        "description": "Get OHLCV (Open, High, Low, Close, Volume) data for a specific stock. Supports daily, weekly, and monthly timeframes.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "maxLength": 50,
              "pattern": "^[a-zA-Z0-9_-]+$",
              "description": "Dataset name",
              "example": "sampleA"
            },
            "required": true,
            "description": "Dataset name",
            "name": "name",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d{4,5}$",
              "description": "Stock code (4-5 digits)",
              "example": "7203"
            },
            "required": true,
            "description": "Stock code (4-5 digits)",
            "name": "code",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "description": "Start date (YYYY-MM-DD)",
              "example": "2024-01-01"
            },
            "required": false,
            "description": "Start date (YYYY-MM-DD)",
            "name": "start_date",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "End date (YYYY-MM-DD)",
              "example": "2024-12-31"
            },
            "required": false,
            "description": "End date (YYYY-MM-DD)",
            "name": "end_date",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "daily",
                "weekly",
                "monthly"
              ],
              "default": "daily",
              "description": "Timeframe for data aggregation",
              "example": "daily"
            },
            "required": false,
            "description": "Timeframe for data aggregation",
            "name": "timeframe",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Stock OHLCV data",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "date": {
                        "type": "string",
                        "description": "Date (YYYY-MM-DD)",
                        "example": "2024-01-15"
                      },
                      "open": {
                        "type": "number",
                        "description": "Open price",
                        "example": 2500
                      },
                      "high": {
                        "type": "number",
                        "description": "High price",
                        "example": 2550
                      },
                      "low": {
                        "type": "number",
                        "description": "Low price",
                        "example": 2480
                      },
                      "close": {
                        "type": "number",
                        "description": "Close price",
                        "example": 2530
                      },
                      "volume": {
                        "type": "integer",
                        "description": "Volume",
                        "example": 1000000
                      }
                    },
                    "required": [
                      "date",
                      "open",
                      "high",
                      "low",
                      "close",
                      "volume"
                    ]
                  }
                }
              }
            }
          },
          "404": {
            "description": "Dataset or stock not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/dataset/{name}/stocks/ohlcv/batch": {
      "get": {
        "tags": [
          "Dataset Data"
        ],
        "summary": "Get batch stock OHLCV data",
        "description": "Get OHLCV (Open, High, Low, Close, Volume) data for multiple stocks in a single request. Returns a record mapping stock codes to their OHLCV data. Maximum 100 stock codes per request.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "maxLength": 50,
              "pattern": "^[a-zA-Z0-9_-]+$",
              "description": "Dataset name",
              "example": "sampleA"
            },
            "required": true,
            "description": "Dataset name",
            "name": "name",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "description": "Comma-separated stock codes (max 100)",
              "example": "7203,9984"
            },
            "required": true,
            "description": "Comma-separated stock codes (max 100)",
            "name": "codes",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Start date (YYYY-MM-DD)",
              "example": "2024-01-01"
            },
            "required": false,
            "description": "Start date (YYYY-MM-DD)",
            "name": "start_date",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "End date (YYYY-MM-DD)",
              "example": "2024-12-31"
            },
            "required": false,
            "description": "End date (YYYY-MM-DD)",
            "name": "end_date",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "daily",
                "weekly",
                "monthly"
              ],
              "default": "daily",
              "description": "Timeframe for data aggregation",
              "example": "daily"
            },
            "required": false,
            "description": "Timeframe for data aggregation",
            "name": "timeframe",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Batch stock OHLCV data",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "date": {
                          "type": "string",
                          "description": "Date (YYYY-MM-DD)",
                          "example": "2024-01-15"
                        },
                        "open": {
                          "type": "number",
                          "description": "Open price",
                          "example": 2500
                        },
                        "high": {
                          "type": "number",
                          "description": "High price",
                          "example": 2550
                        },
                        "low": {
                          "type": "number",
                          "description": "Low price",
                          "example": 2480
                        },
                        "close": {
                          "type": "number",
                          "description": "Close price",
                          "example": 2530
                        },
                        "volume": {
                          "type": "integer",
                          "description": "Volume",
                          "example": 1000000
                        }
                      },
                      "required": [
                        "date",
                        "open",
                        "high",
                        "low",
                        "close",
                        "volume"
                      ]
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Dataset not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/dataset/{name}/stocks": {
      "get": {
        "tags": [
          "Dataset Data"
        ],
        "summary": "Get stock list",
        "description": "Get list of available stocks in the dataset.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "maxLength": 50,
              "pattern": "^[a-zA-Z0-9_-]+$",
              "description": "Dataset name",
              "example": "sampleA"
            },
            "required": true,
            "description": "Dataset name",
            "name": "name",
            "in": "path"
          },
          {
            "schema": {
              "type": "integer",
              "minimum": 1,
              "default": 100,
              "description": "Minimum number of records required",
              "example": 100
            },
            "required": false,
            "description": "Minimum number of records required",
            "name": "min_records",
            "in": "query"
          },
          {
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 10000,
              "description": "Maximum number of results"
            },
            "required": false,
            "description": "Maximum number of results",
            "name": "limit",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "true",
                "false"
              ],
              "description": "Include date range info"
            },
            "required": false,
            "description": "Include date range info",
            "name": "detail",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Stock list",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "stockCode": {
                        "type": "string",
                        "description": "Stock code",
                        "example": "7203"
                      },
                      "record_count": {
                        "type": "integer",
                        "description": "Number of records",
                        "example": 500
                      },
                      "start_date": {
                        "type": "string",
                        "description": "First date",
                        "example": "2020-01-06"
                      },
                      "end_date": {
                        "type": "string",
                        "description": "Last date",
                        "example": "2024-12-27"
                      }
                    },
                    "required": [
                      "stockCode",
                      "record_count"
                    ]
                  }
                }
              }
            }
          },
          "404": {
            "description": "Dataset not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/dataset/{name}/topix": {
      "get": {
        "tags": [
          "Dataset Data"
        ],
        "summary": "Get TOPIX data",
        "description": "Get TOPIX index data from the dataset.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "maxLength": 50,
              "pattern": "^[a-zA-Z0-9_-]+$",
              "description": "Dataset name",
              "example": "sampleA"
            },
            "required": true,
            "description": "Dataset name",
            "name": "name",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "description": "Start date (YYYY-MM-DD)",
              "example": "2024-01-01"
            },
            "required": false,
            "description": "Start date (YYYY-MM-DD)",
            "name": "start_date",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "End date (YYYY-MM-DD)",
              "example": "2024-12-31"
            },
            "required": false,
            "description": "End date (YYYY-MM-DD)",
            "name": "end_date",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "TOPIX data",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "date": {
                        "type": "string",
                        "description": "Date (YYYY-MM-DD)",
                        "example": "2024-01-15"
                      },
                      "open": {
                        "type": "number",
                        "description": "Open price",
                        "example": 2500
                      },
                      "high": {
                        "type": "number",
                        "description": "High price",
                        "example": 2550
                      },
                      "low": {
                        "type": "number",
                        "description": "Low price",
                        "example": 2480
                      },
                      "close": {
                        "type": "number",
                        "description": "Close price",
                        "example": 2530
                      }
                    },
                    "required": [
                      "date",
                      "open",
                      "high",
                      "low",
                      "close"
                    ]
                  }
                }
              }
            }
          },
          "404": {
            "description": "Dataset not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/dataset/{name}/indices/{code}": {
      "get": {
        "tags": [
          "Dataset Data"
        ],
        "summary": "Get index data",
        "description": "Get OHLC data for a specific index.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "maxLength": 50,
              "pattern": "^[a-zA-Z0-9_-]+$",
              "description": "Dataset name",
              "example": "sampleA"
            },
            "required": true,
            "description": "Dataset name",
            "name": "name",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "maxLength": 10,
              "pattern": "^[A-Z]?\\d+$",
              "description": "Index code",
              "example": "I1001"
            },
            "required": true,
            "description": "Index code",
            "name": "code",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "description": "Start date (YYYY-MM-DD)",
              "example": "2024-01-01"
            },
            "required": false,
            "description": "Start date (YYYY-MM-DD)",
            "name": "start_date",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "End date (YYYY-MM-DD)",
              "example": "2024-12-31"
            },
            "required": false,
            "description": "End date (YYYY-MM-DD)",
            "name": "end_date",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Index data",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "date": {
                        "type": "string",
                        "description": "Date (YYYY-MM-DD)",
                        "example": "2024-01-15"
                      },
                      "open": {
                        "type": "number",
                        "description": "Open price",
                        "example": 2500
                      },
                      "high": {
                        "type": "number",
                        "description": "High price",
                        "example": 2550
                      },
                      "low": {
                        "type": "number",
                        "description": "Low price",
                        "example": 2480
                      },
                      "close": {
                        "type": "number",
                        "description": "Close price",
                        "example": 2530
                      }
                    },
                    "required": [
                      "date",
                      "open",
                      "high",
                      "low",
                      "close"
                    ]
                  }
                }
              }
            }
          },
          "404": {
            "description": "Dataset or index not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/dataset/{name}/indices": {
      "get": {
        "tags": [
          "Dataset Data"
        ],
        "summary": "Get index list",
        "description": "Get list of available indices in the dataset.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "maxLength": 50,
              "pattern": "^[a-zA-Z0-9_-]+$",
              "description": "Dataset name",
              "example": "sampleA"
            },
            "required": true,
            "description": "Dataset name",
            "name": "name",
            "in": "path"
          },
          {
            "schema": {
              "type": "integer",
              "minimum": 1,
              "default": 100,
              "description": "Minimum records required"
            },
            "required": false,
            "description": "Minimum records required",
            "name": "min_records",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Comma-separated index codes"
            },
            "required": false,
            "description": "Comma-separated index codes",
            "name": "codes",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Index list",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "indexCode": {
                        "type": "string",
                        "description": "Index code",
                        "example": "I1001"
                      },
                      "indexName": {
                        "type": "string",
                        "description": "Index name",
                        "example": "ÈõªÊ∞óÊ©üÂô®"
                      },
                      "record_count": {
                        "type": "integer",
                        "description": "Number of records",
                        "example": 300
                      },
                      "start_date": {
                        "type": "string",
                        "description": "First date"
                      },
                      "end_date": {
                        "type": "string",
                        "description": "Last date"
                      }
                    },
                    "required": [
                      "indexCode",
                      "indexName",
                      "record_count"
                    ]
                  }
                }
              }
            }
          },
          "404": {
            "description": "Dataset not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/dataset/{name}/margin/batch": {
      "get": {
        "tags": [
          "Dataset Data"
        ],
        "summary": "Get batch margin data",
        "description": "Get margin trading data for multiple stocks in a single request. Returns a record mapping stock codes to their margin data. Maximum 100 stock codes per request.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "maxLength": 50,
              "pattern": "^[a-zA-Z0-9_-]+$",
              "description": "Dataset name",
              "example": "sampleA"
            },
            "required": true,
            "description": "Dataset name",
            "name": "name",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "description": "Comma-separated stock codes (max 100)",
              "example": "7203,9984"
            },
            "required": true,
            "description": "Comma-separated stock codes (max 100)",
            "name": "codes",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Start date (YYYY-MM-DD)",
              "example": "2024-01-01"
            },
            "required": false,
            "description": "Start date (YYYY-MM-DD)",
            "name": "start_date",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "End date (YYYY-MM-DD)",
              "example": "2024-12-31"
            },
            "required": false,
            "description": "End date (YYYY-MM-DD)",
            "name": "end_date",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Batch margin data",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "date": {
                          "type": "string",
                          "description": "Date (YYYY-MM-DD)",
                          "example": "2024-01-15"
                        },
                        "longMarginVolume": {
                          "type": "number",
                          "description": "Long margin volume",
                          "example": 10000
                        },
                        "shortMarginVolume": {
                          "type": "number",
                          "description": "Short margin volume",
                          "example": 5000
                        }
                      },
                      "required": [
                        "date",
                        "longMarginVolume",
                        "shortMarginVolume"
                      ]
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Dataset not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/dataset/{name}/margin/{code}": {
      "get": {
        "tags": [
          "Dataset Data"
        ],
        "summary": "Get margin data",
        "description": "Get margin trading data for a specific stock.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "maxLength": 50,
              "pattern": "^[a-zA-Z0-9_-]+$",
              "description": "Dataset name",
              "example": "sampleA"
            },
            "required": true,
            "description": "Dataset name",
            "name": "name",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d{4,5}$",
              "description": "Stock code (4-5 digits)",
              "example": "7203"
            },
            "required": true,
            "description": "Stock code (4-5 digits)",
            "name": "code",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "description": "Start date (YYYY-MM-DD)",
              "example": "2024-01-01"
            },
            "required": false,
            "description": "Start date (YYYY-MM-DD)",
            "name": "start_date",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "End date (YYYY-MM-DD)",
              "example": "2024-12-31"
            },
            "required": false,
            "description": "End date (YYYY-MM-DD)",
            "name": "end_date",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Margin data",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "date": {
                        "type": "string",
                        "description": "Date (YYYY-MM-DD)",
                        "example": "2024-01-15"
                      },
                      "longMarginVolume": {
                        "type": "number",
                        "description": "Long margin volume",
                        "example": 10000
                      },
                      "shortMarginVolume": {
                        "type": "number",
                        "description": "Short margin volume",
                        "example": 5000
                      }
                    },
                    "required": [
                      "date",
                      "longMarginVolume",
                      "shortMarginVolume"
                    ]
                  }
                }
              }
            }
          },
          "404": {
            "description": "Dataset or stock not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/dataset/{name}/margin": {
      "get": {
        "tags": [
          "Dataset Data"
        ],
        "summary": "Get margin list",
        "description": "Get list of stocks with margin data.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "maxLength": 50,
              "pattern": "^[a-zA-Z0-9_-]+$",
              "description": "Dataset name",
              "example": "sampleA"
            },
            "required": true,
            "description": "Dataset name",
            "name": "name",
            "in": "path"
          },
          {
            "schema": {
              "type": "integer",
              "minimum": 1,
              "default": 10,
              "description": "Minimum records required"
            },
            "required": false,
            "description": "Minimum records required",
            "name": "min_records",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Comma-separated stock codes"
            },
            "required": false,
            "description": "Comma-separated stock codes",
            "name": "codes",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Margin list",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "stockCode": {
                        "type": "string",
                        "description": "Stock code",
                        "example": "7203"
                      },
                      "record_count": {
                        "type": "integer",
                        "description": "Number of records",
                        "example": 100
                      },
                      "start_date": {
                        "type": "string",
                        "description": "First date"
                      },
                      "end_date": {
                        "type": "string",
                        "description": "Last date"
                      },
                      "avg_long_margin": {
                        "type": "number",
                        "description": "Average long margin"
                      },
                      "avg_short_margin": {
                        "type": "number",
                        "description": "Average short margin"
                      }
                    },
                    "required": [
                      "stockCode",
                      "record_count"
                    ]
                  }
                }
              }
            }
          },
          "404": {
            "description": "Dataset not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/dataset/{name}/statements/batch": {
      "get": {
        "tags": [
          "Dataset Data"
        ],
        "summary": "Get batch financial statements",
        "description": "Get financial statements data for multiple stocks in a single request. Returns a record mapping stock codes to their statements data. Maximum 100 stock codes per request. Supports period_type and actual_only filters.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "maxLength": 50,
              "pattern": "^[a-zA-Z0-9_-]+$",
              "description": "Dataset name",
              "example": "sampleA"
            },
            "required": true,
            "description": "Dataset name",
            "name": "name",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "description": "Comma-separated stock codes (max 100)",
              "example": "7203,9984"
            },
            "required": true,
            "description": "Comma-separated stock codes (max 100)",
            "name": "codes",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Start date (YYYY-MM-DD)",
              "example": "2024-01-01"
            },
            "required": false,
            "description": "Start date (YYYY-MM-DD)",
            "name": "start_date",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "End date (YYYY-MM-DD)",
              "example": "2024-12-31"
            },
            "required": false,
            "description": "End date (YYYY-MM-DD)",
            "name": "end_date",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "all",
                "FY",
                "1Q",
                "2Q",
                "3Q"
              ],
              "default": "all",
              "description": "Filter by period type: all (default), FY (full year), Q1, Q2, Q3",
              "example": "FY"
            },
            "required": false,
            "description": "Filter by period type: all (default), FY (full year), Q1, Q2, Q3",
            "name": "period_type",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "true",
                "false"
              ],
              "default": "false",
              "description": "If true, exclude forecast data (records without actual financial data)",
              "example": "true"
            },
            "required": false,
            "description": "If true, exclude forecast data (records without actual financial data)",
            "name": "actual_only",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Batch financial statements data",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "disclosedDate": {
                          "type": "string",
                          "description": "Disclosed date",
                          "example": "2024-05-10"
                        },
                        "typeOfCurrentPeriod": {
                          "type": "string",
                          "description": "Period type (FY, 1Q, 2Q, 3Q). Empty string if unknown.",
                          "example": "FY"
                        },
                        "typeOfDocument": {
                          "type": "string",
                          "description": "Document type. Empty string if unknown.",
                          "example": "FYFinancialStatements_Consolidated_JP"
                        },
                        "earningsPerShare": {
                          "type": "number",
                          "nullable": true,
                          "description": "EPS",
                          "example": 150.5
                        },
                        "profit": {
                          "type": "number",
                          "nullable": true,
                          "description": "Net profit",
                          "example": 1000000000
                        },
                        "equity": {
                          "type": "number",
                          "nullable": true,
                          "description": "Shareholders equity",
                          "example": 5000000000
                        },
                        "nextYearForecastEarningsPerShare": {
                          "type": "number",
                          "nullable": true,
                          "description": "Next year forecast EPS",
                          "example": 160
                        },
                        "bps": {
                          "type": "number",
                          "nullable": true,
                          "description": "Book value per share",
                          "example": 2500
                        },
                        "sales": {
                          "type": "number",
                          "nullable": true,
                          "description": "Net sales",
                          "example": 30000000000
                        },
                        "operatingProfit": {
                          "type": "number",
                          "nullable": true,
                          "description": "Operating profit",
                          "example": 2000000000
                        },
                        "ordinaryProfit": {
                          "type": "number",
                          "nullable": true,
                          "description": "Ordinary profit (J-GAAP)",
                          "example": 2100000000
                        },
                        "operatingCashFlow": {
                          "type": "number",
                          "nullable": true,
                          "description": "Cash flow from operations",
                          "example": 1500000000
                        },
                        "dividendFY": {
                          "type": "number",
                          "nullable": true,
                          "description": "Dividend per share (FY)",
                          "example": 50
                        },
                        "forecastEps": {
                          "type": "number",
                          "nullable": true,
                          "description": "Forecast EPS for current FY",
                          "example": 155
                        },
                        "investingCashFlow": {
                          "type": "number",
                          "nullable": true,
                          "description": "Cash flow from investing",
                          "example": -500000000
                        },
                        "financingCashFlow": {
                          "type": "number",
                          "nullable": true,
                          "description": "Cash flow from financing",
                          "example": -300000000
                        },
                        "cashAndEquivalents": {
                          "type": "number",
                          "nullable": true,
                          "description": "Cash and cash equivalents",
                          "example": 2000000000
                        },
                        "totalAssets": {
                          "type": "number",
                          "nullable": true,
                          "description": "Total assets",
                          "example": 10000000000
                        },
                        "sharesOutstanding": {
                          "type": "number",
                          "nullable": true,
                          "description": "Shares outstanding",
                          "example": 100000000
                        },
                        "treasuryShares": {
                          "type": "number",
                          "nullable": true,
                          "description": "Treasury shares",
                          "example": 5000000
                        }
                      },
                      "required": [
                        "disclosedDate",
                        "typeOfCurrentPeriod",
                        "typeOfDocument",
                        "earningsPerShare",
                        "profit",
                        "equity",
                        "nextYearForecastEarningsPerShare",
                        "bps",
                        "sales",
                        "operatingProfit",
                        "ordinaryProfit",
                        "operatingCashFlow",
                        "dividendFY",
                        "forecastEps",
                        "investingCashFlow",
                        "financingCashFlow",
                        "cashAndEquivalents",
                        "totalAssets",
                        "sharesOutstanding",
                        "treasuryShares"
                      ]
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Dataset not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/dataset/{name}/statements/{code}": {
      "get": {
        "tags": [
          "Dataset Data"
        ],
        "summary": "Get financial statements",
        "description": "Get financial statements data for a specific stock. Includes EPS, profit, equity, sales, operating profit, and other financial metrics. Use period_type to filter by FY/Q1/Q2/Q3 and actual_only to exclude forecast data.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "maxLength": 50,
              "pattern": "^[a-zA-Z0-9_-]+$",
              "description": "Dataset name",
              "example": "sampleA"
            },
            "required": true,
            "description": "Dataset name",
            "name": "name",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "pattern": "^\\d{4,5}$",
              "description": "Stock code (4-5 digits)",
              "example": "7203"
            },
            "required": true,
            "description": "Stock code (4-5 digits)",
            "name": "code",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "description": "Start date (YYYY-MM-DD)",
              "example": "2024-01-01"
            },
            "required": false,
            "description": "Start date (YYYY-MM-DD)",
            "name": "start_date",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "End date (YYYY-MM-DD)",
              "example": "2024-12-31"
            },
            "required": false,
            "description": "End date (YYYY-MM-DD)",
            "name": "end_date",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "all",
                "FY",
                "1Q",
                "2Q",
                "3Q"
              ],
              "default": "all",
              "description": "Filter by period type: all (default), FY (full year), Q1, Q2, Q3",
              "example": "FY"
            },
            "required": false,
            "description": "Filter by period type: all (default), FY (full year), Q1, Q2, Q3",
            "name": "period_type",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "true",
                "false"
              ],
              "default": "false",
              "description": "If true, exclude forecast data (records without actual financial data)",
              "example": "true"
            },
            "required": false,
            "description": "If true, exclude forecast data (records without actual financial data)",
            "name": "actual_only",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Financial statements data",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "disclosedDate": {
                        "type": "string",
                        "description": "Disclosed date",
                        "example": "2024-05-10"
                      },
                      "typeOfCurrentPeriod": {
                        "type": "string",
                        "description": "Period type (FY, 1Q, 2Q, 3Q). Empty string if unknown.",
                        "example": "FY"
                      },
                      "typeOfDocument": {
                        "type": "string",
                        "description": "Document type. Empty string if unknown.",
                        "example": "FYFinancialStatements_Consolidated_JP"
                      },
                      "earningsPerShare": {
                        "type": "number",
                        "nullable": true,
                        "description": "EPS",
                        "example": 150.5
                      },
                      "profit": {
                        "type": "number",
                        "nullable": true,
                        "description": "Net profit",
                        "example": 1000000000
                      },
                      "equity": {
                        "type": "number",
                        "nullable": true,
                        "description": "Shareholders equity",
                        "example": 5000000000
                      },
                      "nextYearForecastEarningsPerShare": {
                        "type": "number",
                        "nullable": true,
                        "description": "Next year forecast EPS",
                        "example": 160
                      },
                      "bps": {
                        "type": "number",
                        "nullable": true,
                        "description": "Book value per share",
                        "example": 2500
                      },
                      "sales": {
                        "type": "number",
                        "nullable": true,
                        "description": "Net sales",
                        "example": 30000000000
                      },
                      "operatingProfit": {
                        "type": "number",
                        "nullable": true,
                        "description": "Operating profit",
                        "example": 2000000000
                      },
                      "ordinaryProfit": {
                        "type": "number",
                        "nullable": true,
                        "description": "Ordinary profit (J-GAAP)",
                        "example": 2100000000
                      },
                      "operatingCashFlow": {
                        "type": "number",
                        "nullable": true,
                        "description": "Cash flow from operations",
                        "example": 1500000000
                      },
                      "dividendFY": {
                        "type": "number",
                        "nullable": true,
                        "description": "Dividend per share (FY)",
                        "example": 50
                      },
                      "forecastEps": {
                        "type": "number",
                        "nullable": true,
                        "description": "Forecast EPS for current FY",
                        "example": 155
                      },
                      "investingCashFlow": {
                        "type": "number",
                        "nullable": true,
                        "description": "Cash flow from investing",
                        "example": -500000000
                      },
                      "financingCashFlow": {
                        "type": "number",
                        "nullable": true,
                        "description": "Cash flow from financing",
                        "example": -300000000
                      },
                      "cashAndEquivalents": {
                        "type": "number",
                        "nullable": true,
                        "description": "Cash and cash equivalents",
                        "example": 2000000000
                      },
                      "totalAssets": {
                        "type": "number",
                        "nullable": true,
                        "description": "Total assets",
                        "example": 10000000000
                      },
                      "sharesOutstanding": {
                        "type": "number",
                        "nullable": true,
                        "description": "Shares outstanding",
                        "example": 100000000
                      },
                      "treasuryShares": {
                        "type": "number",
                        "nullable": true,
                        "description": "Treasury shares",
                        "example": 5000000
                      }
                    },
                    "required": [
                      "disclosedDate",
                      "typeOfCurrentPeriod",
                      "typeOfDocument",
                      "earningsPerShare",
                      "profit",
                      "equity",
                      "nextYearForecastEarningsPerShare",
                      "bps",
                      "sales",
                      "operatingProfit",
                      "ordinaryProfit",
                      "operatingCashFlow",
                      "dividendFY",
                      "forecastEps",
                      "investingCashFlow",
                      "financingCashFlow",
                      "cashAndEquivalents",
                      "totalAssets",
                      "sharesOutstanding",
                      "treasuryShares"
                    ]
                  }
                }
              }
            }
          },
          "404": {
            "description": "Dataset or stock not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/dataset/{name}/sectors/mapping": {
      "get": {
        "tags": [
          "Dataset Data"
        ],
        "summary": "Get sector mapping",
        "description": "Get sector to index mapping.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "maxLength": 50,
              "pattern": "^[a-zA-Z0-9_-]+$",
              "description": "Dataset name",
              "example": "sampleA"
            },
            "required": true,
            "description": "Dataset name",
            "name": "name",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Sector mapping",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "sector_code": {
                        "type": "string",
                        "description": "Sector code",
                        "example": "3650"
                      },
                      "sector_name": {
                        "type": "string",
                        "description": "Sector name",
                        "example": "ÈõªÊ∞óÊ©üÂô®"
                      },
                      "index_code": {
                        "type": "string",
                        "description": "Index code",
                        "example": "I1001"
                      },
                      "index_name": {
                        "type": "string",
                        "description": "Index name",
                        "example": "ÈõªÊ∞óÊ©üÂô®ÊåáÊï∞"
                      }
                    },
                    "required": [
                      "sector_code",
                      "sector_name",
                      "index_code",
                      "index_name"
                    ]
                  }
                }
              }
            }
          },
          "404": {
            "description": "Dataset not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/dataset/{name}/sectors/stock-mapping": {
      "get": {
        "tags": [
          "Dataset Data"
        ],
        "summary": "Get stock to sector mapping",
        "description": "Get mapping of all stock codes to their sector names (33 categories).",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "maxLength": 50,
              "pattern": "^[a-zA-Z0-9_-]+$",
              "description": "Dataset name",
              "example": "sampleA"
            },
            "required": true,
            "description": "Dataset name",
            "name": "name",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Stock to sector mapping",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "code": {
                        "type": "string",
                        "description": "Stock code",
                        "example": "7203"
                      },
                      "sector33Name": {
                        "type": "string",
                        "description": "Sector name (33 categories)",
                        "example": "Ëº∏ÈÄÅÁî®Ê©üÂô®"
                      }
                    },
                    "required": [
                      "code",
                      "sector33Name"
                    ]
                  }
                }
              }
            }
          },
          "404": {
            "description": "Dataset not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/dataset/{name}/sectors/{sectorName}/stocks": {
      "get": {
        "tags": [
          "Dataset Data"
        ],
        "summary": "Get stocks in a sector",
        "description": "Get list of stock codes belonging to a specific sector.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "maxLength": 50,
              "pattern": "^[a-zA-Z0-9_-]+$",
              "description": "Dataset name",
              "example": "sampleA"
            },
            "required": true,
            "description": "Dataset name",
            "name": "name",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "maxLength": 50,
              "pattern": "^[\\u3040-\\u309F\\u30A0-\\u30FF\\u4E00-\\u9FAF\\u3000-\\u303Fa-zA-Z0-9_\\-\\s\\u30FB]+$",
              "description": "Sector name",
              "example": "ÈõªÊ∞óÊ©üÂô®"
            },
            "required": true,
            "description": "Sector name",
            "name": "sectorName",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Stock codes in the sector",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid sector name encoding",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Dataset not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/dataset/{name}/sectors": {
      "get": {
        "tags": [
          "Dataset Data"
        ],
        "summary": "Get all sectors with stock count",
        "description": "Get list of all sectors with their stock counts.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "maxLength": 50,
              "pattern": "^[a-zA-Z0-9_-]+$",
              "description": "Dataset name",
              "example": "sampleA"
            },
            "required": true,
            "description": "Dataset name",
            "name": "name",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Sectors with stock count",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "sector_code": {
                        "type": "string",
                        "description": "Sector code",
                        "example": "3650"
                      },
                      "sector_name": {
                        "type": "string",
                        "description": "Sector name",
                        "example": "ÈõªÊ∞óÊ©üÂô®"
                      },
                      "index_code": {
                        "type": "string",
                        "description": "Index code",
                        "example": "I1001"
                      },
                      "index_name": {
                        "type": "string",
                        "description": "Index name",
                        "example": "ÈõªÊ∞óÊ©üÂô®ÊåáÊï∞"
                      },
                      "stock_count": {
                        "type": "integer",
                        "description": "Number of stocks in this sector",
                        "example": 45
                      }
                    },
                    "required": [
                      "sector_code",
                      "sector_name",
                      "index_code",
                      "index_name",
                      "stock_count"
                    ]
                  }
                }
              }
            }
          },
          "404": {
            "description": "Dataset not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/market/stocks/{code}/ohlcv": {
      "get": {
        "tags": [
          "Market Data"
        ],
        "summary": "Get stock OHLCV data from market.db",
        "description": "Get OHLCV (Open, High, Low, Close, Volume) data for a specific stock from market.db.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "minLength": 1,
              "description": "Stock code",
              "example": "7203"
            },
            "required": true,
            "description": "Stock code",
            "name": "code",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "description": "Start date (YYYY-MM-DD)",
              "example": "2024-01-01"
            },
            "required": false,
            "description": "Start date (YYYY-MM-DD)",
            "name": "start_date",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "End date (YYYY-MM-DD)",
              "example": "2024-12-31"
            },
            "required": false,
            "description": "End date (YYYY-MM-DD)",
            "name": "end_date",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Stock OHLCV data",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "date": {
                        "type": "string",
                        "description": "Date (YYYY-MM-DD)",
                        "example": "2024-01-15"
                      },
                      "open": {
                        "type": "number",
                        "description": "Open price",
                        "example": 2500
                      },
                      "high": {
                        "type": "number",
                        "description": "High price",
                        "example": 2550
                      },
                      "low": {
                        "type": "number",
                        "description": "Low price",
                        "example": 2480
                      },
                      "close": {
                        "type": "number",
                        "description": "Close price",
                        "example": 2530
                      },
                      "volume": {
                        "type": "integer",
                        "description": "Volume",
                        "example": 1000000
                      }
                    },
                    "required": [
                      "date",
                      "open",
                      "high",
                      "low",
                      "close",
                      "volume"
                    ]
                  }
                }
              }
            }
          },
          "404": {
            "description": "Stock not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/market/stocks": {
      "get": {
        "tags": [
          "Market Data"
        ],
        "summary": "Get all stocks data for screening",
        "description": "Get all stocks with OHLCV history for a specified period. Used for screening.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "enum": [
                "prime",
                "standard"
              ],
              "default": "prime",
              "description": "Market code",
              "example": "prime"
            },
            "required": false,
            "description": "Market code",
            "name": "market",
            "in": "query"
          },
          {
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 1000,
              "default": 300,
              "description": "Number of days of history",
              "example": 300
            },
            "required": false,
            "description": "Number of days of history",
            "name": "history_days",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "All stocks data",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "code": {
                        "type": "string",
                        "description": "Stock code",
                        "example": "7203"
                      },
                      "company_name": {
                        "type": "string",
                        "description": "Company name",
                        "example": "„Éà„É®„ÇøËá™ÂãïËªä"
                      },
                      "data": {
                        "type": "array",
                        "items": {
                          "type": "object",
                          "properties": {
                            "date": {
                              "type": "string",
                              "description": "Date (YYYY-MM-DD)",
                              "example": "2024-01-15"
                            },
                            "open": {
                              "type": "number",
                              "description": "Open price",
                              "example": 2500
                            },
                            "high": {
                              "type": "number",
                              "description": "High price",
                              "example": 2550
                            },
                            "low": {
                              "type": "number",
                              "description": "Low price",
                              "example": 2480
                            },
                            "close": {
                              "type": "number",
                              "description": "Close price",
                              "example": 2530
                            },
                            "volume": {
                              "type": "integer",
                              "description": "Volume",
                              "example": 1000000
                            }
                          },
                          "required": [
                            "date",
                            "open",
                            "high",
                            "low",
                            "close",
                            "volume"
                          ]
                        },
                        "description": "OHLCV data array"
                      }
                    },
                    "required": [
                      "code",
                      "company_name",
                      "data"
                    ]
                  }
                }
              }
            }
          },
          "404": {
            "description": "Market database not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/market/topix": {
      "get": {
        "tags": [
          "Market Data"
        ],
        "summary": "Get TOPIX data from market.db",
        "description": "Get TOPIX index data from market.db.",
        "parameters": [
          {
            "schema": {
              "type": "string",
              "description": "Start date (YYYY-MM-DD)",
              "example": "2024-01-01"
            },
            "required": false,
            "description": "Start date (YYYY-MM-DD)",
            "name": "start_date",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "End date (YYYY-MM-DD)",
              "example": "2024-12-31"
            },
            "required": false,
            "description": "End date (YYYY-MM-DD)",
            "name": "end_date",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "TOPIX data",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "date": {
                        "type": "string",
                        "description": "Date (YYYY-MM-DD)",
                        "example": "2024-01-15"
                      },
                      "open": {
                        "type": "number",
                        "description": "Open price",
                        "example": 2500
                      },
                      "high": {
                        "type": "number",
                        "description": "High price",
                        "example": 2550
                      },
                      "low": {
                        "type": "number",
                        "description": "Low price",
                        "example": 2480
                      },
                      "close": {
                        "type": "number",
                        "description": "Close price",
                        "example": 2530
                      }
                    },
                    "required": [
                      "date",
                      "open",
                      "high",
                      "low",
                      "close"
                    ]
                  }
                }
              }
            }
          },
          "404": {
            "description": "Market database not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    }
  }
}
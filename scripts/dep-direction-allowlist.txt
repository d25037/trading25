# Dependency Direction Allowlist — ts→bt references
#
# This file lists apps/ts/ files that are allowed to reference bt server
# (localhost:3002, BT_API_URL, /bt/api/, BacktestClient, etc.)
#
# Rules:
# - New entries require PR comment explaining the reason
# - When a file's bt reference is removed, delete its entry here
# - CI staleness check will fail if an entry no longer matches any pattern
# - Lines starting with # are comments; blank lines are ignored

# ─────────────────────────────────────────────────────────
# [permanent] bt:sync tooling — required for OpenAPI schema → TS type generation
# ─────────────────────────────────────────────────────────
apps/ts/packages/shared/scripts/fetch-bt-openapi.ts
apps/ts/packages/shared/scripts/check-bt-types.ts
apps/ts/packages/shared/src/clients/backtest/generated/type-compatibility-check.ts

# ─────────────────────────────────────────────────────────
# [phase3-removal] ts→bt acknowledged violations
# Remove entries as Phase 4 resolves each category
# ─────────────────────────────────────────────────────────

# NOTE: Phase 3F removed /bt/api/ prefix from web hooks, so those files
# now use /api/... paths only. The dep-direction pattern no longer detects
# bt dependency in these files. Pattern redesign deferred to Phase 4.

# Web components/hooks (still import from @trading25/shared/clients/backtest)
apps/ts/packages/web/src/components/Lab/LabResultSection.tsx
apps/ts/packages/web/src/hooks/useBtOHLCV.ts
apps/ts/packages/web/src/types/backtest.ts

# Vite proxy config (localhost:3002 reference)
apps/ts/packages/web/vite.config.ts

# CLI api-client (localhost:3002 default)
apps/ts/packages/cli/src/utils/api-client.ts

# CLI backtest commands (BT_API_URL reference)
apps/ts/packages/cli/src/commands/backtest/run.ts
apps/ts/packages/cli/src/commands/backtest/cancel.ts
apps/ts/packages/cli/src/commands/backtest/list.ts
apps/ts/packages/cli/src/commands/backtest/results.ts
apps/ts/packages/cli/src/commands/backtest/status.ts
apps/ts/packages/cli/src/commands/backtest/validate.ts
apps/ts/packages/cli/src/commands/backtest/error-handler.ts

# API server proxies (archived code, still contains BacktestClient references)
apps/ts/packages/api/src/routes/analytics/fundamentals.ts
apps/ts/packages/api/src/routes/__tests__/fundamentals.test.ts
apps/ts/packages/api/src/routes/jquants/statements.ts
apps/ts/packages/api/src/services/dataset/dataset-data-service.ts
apps/ts/packages/api/src/services/dataset/dataset-data-service.test.ts

# API server deprecated (ts-123) — fundamentals-data.ts は既に削除済み
apps/ts/packages/api/src/services/stock-data.ts

# Shared client library (Phase 4 廃止予定)
apps/ts/packages/shared/src/clients/backtest/BacktestClient.ts
apps/ts/packages/shared/src/clients/backtest/BacktestClient.test.ts
apps/ts/packages/shared/src/clients/backtest/index.ts
apps/ts/packages/shared/src/clients/backtest/types.ts
